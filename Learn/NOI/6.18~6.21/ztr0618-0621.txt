题目来源：CodeChef CHEFCIRC
题目大意：给定n，m和平面上n个点，找出一个半径最小的圆，使其包含至少m个点。
n,m<=500，2s。
题目解法：枚举两个在圆上的点，二分半径，考虑此类圆是否包含其他点，反演一下，推一下式子，是可以数点的。
其实上面这个做法是扯淡，因为确定两个点在圆上的时候，半径大的圆的区域并不覆盖半径小的圆的区域。
枚举一个在圆上的点，二分半径，现在还差圆心到该点的夹角。
考虑每一个点要被包含，发现这限定了夹角的范围。
也就是给你一堆区间，问是否有一个点被覆盖了超过m次，经典问题。





题目来源：CodeChef DISTNUM3
题目大意：有一棵点数为n点上带颜色的树，支持q次操作：
1. 询问一条路径上所有点共有多少种颜色。
2. 修改一个点的颜色。
n<=1e5，6s。
题目解法：树上带修改莫队练习题。树上按dfs序分块，带修改时块大小O(n^2/3)。
时间复杂度O(n^5/3)。





题目来源：CodeChef FOURSQ
题目大意：给定一个质数P，有一个全部为<=1000正整数的序列A[1...n]，支持q次操作：
1. 修改一个位置的数。
2. 给定一个区间，你需要找到四个数，使得模P意义下，这四个数的平方和等于序列上这个区间内的数的乘积。
n,q<=1e5，P<=1e12，5s。
题目解法：求乘积是很容易的，但是将其表示成四个数的完全平方和并不容易，即使只要模意义下相等。
考虑Lagrange四平方和定理（任意一个正/非负整数一定能表示成四个完全平方数的和）的证明是怎样的：
1. 给出一个构造，可以在a，b方案已知的情况下得出一个a×b方案。
(a2 + b2 + c2 + d2)(x2 + y2 + z2 + w2) = (ax + by + cz + dw)2 + (ay - bx + cw - dz)2 + (az - bw - cx + dy)2 + (aw + bz - cy - dx)2
2. 考虑0，1，2与其他奇素数的情况。
但是这里我们甚至很难做1e5次1e12级别的质因数分解，但是我们考虑我们的目标一定是若干个1000以下的数的乘积。
注意到1. 中的构造方法是个多项式的构造方法，也即，模意义下是合理的。
因此若要将其表示，只需预处理好1000以下的每个数的表示，通过构造方法合成得到乘积的表示即可，合成过程中也执行取模。





题目来源：Codechef TUPLES
题目大意：给定X[1...n]，设Y[i][j]=X[i]*X[j]%359999。
计算有多少组a,b,c,d,e,f，使得gcd(Y[a][b],Y[c][d],Y[e][f])=1。
n<=1e6，6s。
题目解法：我们只要算出g[x]表示x在Y中出现的次数，后面的部分是一个很简单的容斥。
先考虑f[x]表示值x在X中出现的次数，那么有g[x*y%359999]+=f[x]*f[y]这样一个卷积形式。
factor 359999 -> 599 601
考虑改设g[x1][x2]表示模599为x1,模601为x2，这样的数在Y中的出现次数，f[][]亦然。
那么有g[x1*y1%599][x2*y2%601]+=f[x1][x2]*f[y1][y2]这样的形式。
众所周知，下标为乘模质数的卷积，可以取出原根将其转化为循环卷积，这里就是二维fft。





题目来源：CodeChef TUPLES2
题目大意：给定一棵点数为n的树，考虑树上的m=C(n,2)条不同的路径，从中选出三条不同的路径有C(m,3)种选法。
性质1：这三条路径的共六个端点，没有重复的。
性质2：这三条路径中任意两条，都至少有一个公共点。
求多少种选法满足上述两个性质的恰好一个。
n<=3e5，2s。
题目解法：对条件容斥一下。考虑性质2的三条路径交于哪条链，对这条路径点分治即可，然是可能会TLE。
然后dp的时候考虑一个子树内已经做了几条链，有几条链还在往上延伸。性质1限制了转移时能不能同时有超过一条路径加入或结束。





题目来源：Codechef BEARTRAP
题目大意：这是一个交互题。
神秘链接www.gamedesign.jp/flash/chatnoir/charnoir.html
在这道题中：
地图一定是N=20层的正六边形（1+6+12+...+6(N-1)），且开始没有障碍物。
每轮猫先走，然后你放，你必须在M=20轮内使猫的位置和外部已经不联通。
保证猫的策略是先选择一条连向外部的最短路，走这条路径的第一步。
题目解法：靠近边界的时候，路径会变的唯一。设置一个坑，让猫走进去然后封住然后不让猫出来就好了。
注意要坑要离边界一定距离而不能贴着边界，否则等猫进来的时候已经快结束了，可能会导致回合数不够。





