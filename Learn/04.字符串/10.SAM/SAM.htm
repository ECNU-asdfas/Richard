<!DOCTYPE html>
<!-- saved from url=(0047)https://huntzhan.org/suffix-automaton-tutorial/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Suffix Automaton Tutorial</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="https://huntzhan.org/favicon.ico">

    <link rel="stylesheet" type="text/css" href="./SAM_files/screen.css">
    <link rel="stylesheet" type="text/css" href="./SAM_files/css">

    <link rel="canonical" href="http://huntzhan.org/suffix-automaton-tutorial/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="http://huntzhan.org/suffix-automaton-tutorial/amp/">
    
    <meta property="og:site_name" content="Coding All The Ways">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Suffix Automaton Tutorial">
    <meta property="og:description" content="Preface 目前中英文站点上并没有很好的 Suffix Automaton (后缀自动机, 简称 SAM ) 教程. 比较知名的材料有两个, 一是陈立杰的 营员交流资料 , 二是某俄国人的某 SAM 博文, 但这两个材料都不好懂. 在下反复啃了几天后, 略有所得, 在此记录一下. Introduction 较为靠谱的 SAM  资料: A short guide to suffix automata - Codeforces MAXimal :: algo :: Суффиксный автомат. Построение и применения, 用 Yandex 提供的机翻服务 勉强可以看懂. 后缀自动机：O(N)的构建及应用 - wmdcstdio的专栏 - 博客频道 -">
    <meta property="og:url" content="http://huntzhan.org/suffix-automaton-tutorial/">
    <meta property="article:published_time" content="2016-11-06T12:56:33.000Z">
    <meta property="article:modified_time" content="2016-11-06T13:01:07.000Z">
    <meta property="article:tag" content="Algorithm">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Suffix Automaton Tutorial">
    <meta name="twitter:description" content="Preface 目前中英文站点上并没有很好的 Suffix Automaton (后缀自动机, 简称 SAM ) 教程. 比较知名的材料有两个, 一是陈立杰的 营员交流资料 , 二是某俄国人的某 SAM 博文, 但这两个材料都不好懂. 在下反复啃了几天后, 略有所得, 在此记录一下. Introduction 较为靠谱的 SAM  资料: A short guide to suffix automata - Codeforces MAXimal :: algo :: Суффиксный автомат. Построение и применения, 用 Yandex 提供的机翻服务 勉强可以看懂. 后缀自动机：O(N)的构建及应用 - wmdcstdio的专栏 - 博客频道 -">
    <meta name="twitter:url" content="http://huntzhan.org/suffix-automaton-tutorial/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Hunt Zhan">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Algorithm">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Coding All The Ways",
        "logo": "http://huntzhan.org/ghost/img/ghosticon.jpg"
    },
    "author": {
        "@type": "Person",
        "name": "Hunt Zhan",
        "image": {
            "@type": "ImageObject",
            "url": "https://ocdnb8ugz.qnssl.com/huntzhan-compressed.jpg",
            "width": 460,
            "height": 460
        },
        "url": "http://huntzhan.org/author/hunt/",
        "sameAs": []
    },
    "headline": "Suffix Automaton Tutorial",
    "url": "https://huntzhan.org/suffix-automaton-tutorial/",
    "datePublished": "2016-11-06T12:56:33.000Z",
    "dateModified": "2016-11-06T13:01:07.000Z",
    "keywords": "Algorithm",
    "description": "Preface 目前中英文站点上并没有很好的 Suffix Automaton (后缀自动机, 简称 SAM ) 教程. 比较知名的材料有两个, 一是陈立杰的 营员交流资料 , 二是某俄国人的某 SAM 博文, 但这两个材料都不好懂. 在下反复啃了几天后, 略有所得, 在此记录一下. Introduction 较为靠谱的 SAM  资料: A short guide to suffix automata - Codeforces MAXimal :: algo :: Суффиксный автомат. Построение и применения, 用 Yandex 提供的机翻服务 勉强可以看懂. 后缀自动机：O(N)的构建及应用 - wmdcstdio的专栏 - 博客频道 -",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://huntzhan.org"
    }
}
    </script>

    <script type="text/javascript" src="./SAM_files/ghost-url.min.js"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "f4b0a4a8b364"
});
</script>
    <meta name="generator" content="Ghost 0.11">
    <link rel="alternate" type="application/rss+xml" title="Coding All The Ways" href="https://huntzhan.org/rss/">
    <!-- Casper Style -->
<style>
body.nav-opened .site-wrapper {
    -webkit-transform: translate3D(-350px, 0, 0);
        -ms-transform: translate3D(-350px, 0, 0);
            transform: translate3D(-350px, 0, 0);
}
body.nav-opened .nav-cover {
    right: 350px;
}
.nav {
    width: 350px;
}
.nav li a {
    text-overflow: "";
    font-size: 1.7rem;
    padding: 0.7rem 5%;
}
.nav li:before {
    content: "";
}
.nav li a::after {
    content: " ";
}
.nav li a:after {
    content: " ";
}
.nav .nav-current a:after {
    border-bottom: none;
}
.nav a:hover {
    background-color: rgba(14,14,150,0.4);
    border-radius: 10px;
    
    -o-transition: .4s;
    -ms-transition: .4s;
    -moz-transition: .4s;
    -webkit-transition: .4s;
    transition: .4s;
}
code, tt {
    font-size: 1.1em;
}
.copyright {
    display: none;
}
.poweredby {
    display: none;
}
.read-next {
    display: none;
}
</style>
<style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><link href="./SAM_files/prism.min.css" rel="stylesheet" type="text/css"><link href="./SAM_files/prism-solarizedlight.min.css" rel="stylesheet" type="text/css"><link href="./SAM_files/prism-line-numbers.min.css" rel="stylesheet" type="text/css"><style>
     .language-css .token.string,
     .style .token.string,
     .token.entity,
     .token.operator,
     .token.url {
       background: hsla(0, 0%, 100%, 0) none repeat scroll 0 0;
     }
     </style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body class="post-template tag-algorithm nav-closed"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="https://huntzhan.org/suffix-automaton-tutorial/#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
            <li class="nav-home" role="presentation"><a href="https://huntzhan.org/">Home</a></li>
            <li class="nav-archive" role="presentation"><a href="https://huntzhan.org/archive-post/">Archive</a></li>
    </ul>
        <a class="subscribe-button icon-feed" href="http://huntzhan.org/rss/">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
            <a class="menu-button icon-menu" href="https://huntzhan.org/suffix-automaton-tutorial/#"><span class="word">Menu</span></a>
    </nav>
</header>

<main class="content" role="main">
    <article class="post tag-algorithm">

        <header class="post-header">
            <h1 class="post-title">Suffix Automaton Tutorial</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2016-11-06">06 November 2016</time>  on <a href="https://huntzhan.org/tag/algorithm/">Algorithm</a>
            </section>
        </header>

        <section class="post-content">
            <h2 id="preface">Preface</h2>

<p>目前中英文站点上并没有很好的 Suffix Automaton (后缀自动机, 简称 SAM ) 教程. 比较知名的材料有两个, 一是陈立杰的 <em>营员交流资料</em> , 二是某俄国人的某 SAM 博文, 但这两个材料都不好懂. 在下反复啃了几天后, 略有所得, 在此记录一下.</p>

<h2 id="introduction">Introduction</h2>

<p>较为靠谱的 SAM  资料:</p>

<ul>
<li><a href="http://codeforces.com/blog/entry/20861">A short guide to suffix automata - Codeforces</a></li>
<li><a href="http://e-maxx.ru/algo/suffix_automata">MAXimal :: algo :: Суффиксный автомат. Построение и применения</a>, 用 <a href="https://translate.yandex.com/translate">Yandex 提供的机翻服务</a> 勉强可以看懂.</li>
<li><a href="http://blog.csdn.net/wmdcstdio/article/details/44780707">后缀自动机：O(N)的构建及应用 - wmdcstdio的专栏 - 博客频道 - CSDN.NET</a>, 上文的中文翻译, 翻译质量良好, 但是排版让人读起来比较痛苦.</li>
</ul>

<p>TL;DR:</p>

<ul>
<li>SAM 与 suffix tree 是等价的.</li>
<li>建立 SAM 的 time/space complexity: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.83em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-4" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-5" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-6" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">O(n)</script>.</li>
<li>实现的代码很简单 (小于 40 行), 但理解起来有难度.</li>
</ul>

<p>SAM 是处理 String 相关问题的有力工具, 可以解决包括但不限于以下问题:</p>

<ul>
<li>Verify <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 1.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.914em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.91em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">W</script> is substring of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">T</script>.</li>
<li>Verify <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 1.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.914em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.91em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">W</script> is suffix of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">T</script>.</li>
<li>Count the number of unique substrings in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-19" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">T</script>.</li>
<li>Count the total length of unique substrings in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-22" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">T</script>.</li>
<li>Count the number of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-25" style="width: 1.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.914em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.91em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">W</script> in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">T</script>.</li>
<li>Find the first position of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 1.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.914em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.91em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">W</script> in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-34" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-35"><span class="mi" id="MathJax-Span-36" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">T</script>.</li>
<li>Find all positions of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" style="width: 1.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.914em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.91em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">W</script> in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-40" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">T</script>.</li>
<li>Find the longest common substring of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" style="width: 1.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1001em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-44"><span class="msubsup" id="MathJax-Span-45"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-46" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mn" id="MathJax-Span-47" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">T_1</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-48" style="width: 1.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1001em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-49"><span class="msubsup" id="MathJax-Span-50"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-51" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mn" id="MathJax-Span-52" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-15">T_2</script>.</li>
<li>Find the longest common substring from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-53" style="width: 1.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1001em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-54"><span class="msubsup" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-56" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mn" id="MathJax-Span-57" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-16">T_1</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-58" style="width: 1.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.957em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1000.96em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-59"><span class="msubsup" id="MathJax-Span-60"><span style="display: inline-block; position: relative; width: 0.957em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-61" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-62" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-17">T_k</script>.</li>
<li>Find the smallest cyclic shift of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-63" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-64"><span class="mi" id="MathJax-Span-65" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">T</script>.</li>
<li>Find the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-66" style="width: 1.565em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.217em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.17em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-69" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-70" style="font-family: STIXGeneral-Italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mi>t</mi><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">kth</script> smallest substring of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-71" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">T</script>.</li>
<li>Find the shortest string that is not a substring of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-74" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-75"><span class="mi" id="MathJax-Span-76" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">T</script>.</li>
</ul>

<h2 id="automatonthedefinition">Automaton: The Definition</h2>

<p>Suffix Automaton 里的 <em>Automaton</em> 其实就是 <a href="https://en.wikipedia.org/wiki/Deterministic_finite_automaton">DFA</a> , 以下是 Wiki 中的定义:</p>

<blockquote>
  <p>A <strong>deterministic finite automaton</strong> <em>M</em> is a 5-<a href="https://en.wikipedia.org/wiki/N-tuple">tuple</a>, (<em>Q</em>, Σ, δ, <em>q0</em>, <em>F</em>), consisting of</p>
  
  <ul>
  <li>a finite set of <a href="https://en.wikipedia.org/wiki/State_%28computer_science%29">states</a> (<em>Q</em>)</li>
  <li>a finite set of input symbols called the <a href="https://en.wikipedia.org/wiki/Alphabet_%28computer_science%29">alphabet</a> (Σ)</li>
  <li>a transition <a href="https://en.wikipedia.org/wiki/Function_%28mathematics%29">function</a> (δ&nbsp;: <em>Q</em> × Σ → <em>Q</em>)</li>
  <li>an initial or <a href="https://en.wikipedia.org/wiki/Finite_state_machine#Start_state">start state</a> (<em>q0</em> ∈ <em>Q</em>)</li>
  <li>a set of <a href="https://en.wikipedia.org/wiki/Finite_state_machine#Accept_.28or_final.29_states">accept states</a> (<em>F</em> ⊆ <em>Q</em>)</li>
  </ul>
</blockquote>

<p>Suffix Automaton, 顾名思义就是可以识别 Suffix 的 Automaton, <a href="http://codeforces.com/blog/entry/20861">A short guide to suffix automata - Codeforces</a> 中有如下的描述:</p>

<blockquote>
  <p>A <strong>suffix automaton</strong> <em>A</em> for a string <em>s</em> is a minimal finite automaton that recognizes the suffixes of <em>s</em>. This means that <em>A</em> is a directed acyclic graph with an initial node <em>i</em>, a set of <em>terminal</em> nodes, and the arrows between nodes are labeled by letters of <em>s</em>. To test whether <em>w</em> is a suffix of <em>s</em> it is enough to start from the initial node of <em>i</em>&nbsp;and follow the arrows corresponding to the letters of <em>w</em>. If we are able to do this for every letter of <em>w</em> and end up in a terminal node, <em>w</em> is a suffix of <em>s</em>.</p>
</blockquote>

<p>以下图为例, 下图是 <em>"abcb"</em> 的对应 SAM:</p>

<p><img src="./SAM_files/what-is.png" alt="what-is.png"></p>

<p>可以看到, 从 start state 出发的 paths,  <em>"abcb"</em>, <em>"bcb"</em>, <em>"cb"</em>, <em>"b"</em>, 都能到达 accept state, 这些路径的集合即为 <em>"abcb"</em> suffixes 的集合.</p>

<h2 id="stateofsam">State Of SAM</h2>

<p>一个关键的问题是, <strong>SAM 里的 State 到底有什么含义?</strong></p>

<p>在介绍 State 的含义之前, 需要先了解一个定义. 给定 String <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-77" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">T</script> 与 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-80" style="width: 0.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.393em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.35em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">s</script>, 定义 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-83" style="width: 22.007em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.19em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1017.1em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-86" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-87" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-88" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-89" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-90" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-91" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-92" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-93" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-94" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">s</span><span class="mo" id="MathJax-Span-95" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-96" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-97" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">{</span><span class="mi" id="MathJax-Span-98" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-99" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-100" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-101" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∣</span><span class="mi" id="MathJax-Span-102" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-103" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-104" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-105" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-107" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-108" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-109" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">:</span><span class="mi" id="MathJax-Span-110" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-111" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-112" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-113" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-114" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-115" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mo" id="MathJax-Span-116" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>T</mi><mo>,</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false" stretchy="false">{</mo><mi>e</mi><mi>n</mi><mi>d</mi><mo>∣</mo><mi>T</mi><mo stretchy="false">[</mo><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mo>:</mo><mi>e</mi><mi>n</mi><mi>d</mi><mo stretchy="false">]</mo><mo>=</mo><mi>s</mi><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">endpos(T, s) = \{ end \mid T[begin:end] = s \}</script>. 也就是说, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117" style="width: 6.426em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.993em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.95em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-120" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-121" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-122" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-123" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-124" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-125" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-126" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-127" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-128" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">s</span><span class="mo" id="MathJax-Span-129" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>T</mi><mo>,</mo><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25">endpos(T, s)</script> 表示了所有在 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-130" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">T</script> 中出现的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-133" style="width: 0.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.393em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.35em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">s</script> 的<strong>结束位置(下标)</strong>. 如果有两个 Strings, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-136" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-137"><span class="msubsup" id="MathJax-Span-138"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-139" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-140" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">s_1</script> 与 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="msubsup" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-144" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-145" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">s_2</script>, 如果有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-146" style="width: 15.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.198em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1012.15em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-147"><span class="mi" id="MathJax-Span-148" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-149" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-150" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-151" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-152" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-153" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-154" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-155" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-156" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-157" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-158" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-159" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-160" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-161" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-162" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-163" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-164" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-165" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-166" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-167" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-168" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-169" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-170" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-171" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-172" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-173" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-174" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>T</mi><mo>,</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>T</mi><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-30">endpos(T, s_1) = endpos(T, s_2)</script>, 则  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-175" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-176"><span class="msubsup" id="MathJax-Span-177"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-178" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-179" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-31">s_1</script> 与 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-180" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-181"><span class="msubsup" id="MathJax-Span-182"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-183" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-184" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-32">s_2</script> 是 <strong>endpos-equivalent</strong> 的.</p>

<p>在上一小节的例子中, 可以看到每个 state 可以有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-185" style="width: 1.912em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.478em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.39em 2.693em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-186"><span class="mo" id="MathJax-Span-187" style="font-family: STIXGeneral-Regular;">≥</span><span class="mn" id="MathJax-Span-188" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.164em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-33">\geq 1</script> 的 indegrees, 这意味着 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-189" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">u</script> 可以识别 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-192" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-193"><span class="mi" id="MathJax-Span-194" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">T</script> 的某个 substrings 集合, 设这个集合为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-195" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-198" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-199" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-200" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-201" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-202" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-203" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-204" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-205" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-206" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-207" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-208" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-209" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-36">substrings(u)</script>. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-210" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-213" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-214" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-215" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-216" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-217" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-218" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-219" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-220" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-221" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-222" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-223" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-224" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-37">substrings(u)</script> 有如下的 property:</p>

<p>对于 SAM 中的任意 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-225" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-226"><span class="mi" id="MathJax-Span-227" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">u</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-228" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-229"><span class="mi" id="MathJax-Span-230" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-231" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-232" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-233" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-234" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-235" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-236" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-237" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-238" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-239" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-240" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-241" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-242" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">substrings(u)</script> 中的任意两个 substrings 必然是 <strong>endpos-equivalent</strong> 的. 以 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-243" style="width: 6.426em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.993em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.91em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-244"><span class="mi" id="MathJax-Span-245" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-246" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mi" id="MathJax-Span-247" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-248" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-249" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-250" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-251" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>="</mo><mi>a</mi><mi>b</mi><mi>c</mi><mi>b</mi><mo>"</mo></math></span></span><script type="math/tex" id="MathJax-Element-40">T = "abcb"</script> 为例(见上小节的图例), 显然的, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-252" style="width: 10.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.945em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.86em 2.737em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-253"><span class="mo" id="MathJax-Span-254" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-255" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-256" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-257" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-258" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-259" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-260" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-261" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mi" id="MathJax-Span-262" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-263" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-264" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-265" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-266" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mo" id="MathJax-Span-267" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>"</mo><mi>a</mi><mi>b</mi><mi>c</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>b</mi><mi>c</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>c</mi><mo>"</mo></math></span></span><script type="math/tex" id="MathJax-Element-41">"abc", "bc", "c"</script> 是 endpos-equivalent 的, 他们的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-268" style="width: 3.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.867em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.82em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-271" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-272" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-273" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-274" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-275" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">endpos</script> 集合都是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-276" style="width: 1.912em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.478em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.39em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-277"><span class="mo" id="MathJax-Span-278" style="font-family: STIXGeneral-Regular;">{</span><span class="mn" id="MathJax-Span-279" style="font-family: STIXGeneral-Regular;">2</span><span class="mo" id="MathJax-Span-280" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-43">\{ 2 \}</script>.</p>

<p>所以, 可以根据 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-281" style="width: 3.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.867em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.82em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-284" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-285" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-286" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-287" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-288" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">endpos</script> 的定义, 将 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-289" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-290"><span class="mi" id="MathJax-Span-291" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">T</script> 的所有 substrings 分成若干个类, 使每个类中的 substrings 都是 endpos-equivalent 的, 这样的分类结果会与 SAM 中的 states 一一对应.</p>

<p>为了进一步明确 state 的含义, 我们先来思考一个问题: <strong>对于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-292" style="width: 0.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.648em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.725em 1000.65em 2.629em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-293"><span class="mi" id="MathJax-Span-294" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.088em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">T</script> 的两个任意的 substrings <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-295" style="width: 1.079em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.682em 1000.82em 2.5em -999.998em); top: -2.237em; left: 0em;"><span class="mrow" id="MathJax-Span-296"><span class="msubsup" id="MathJax-Span-297"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px;"><span style="position: absolute; clip: rect(3.447em 1000.35em 4.137em -999.998em); top: -4.003em; left: 0em;"><span class="mi" id="MathJax-Span-298" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.39em;"><span class="mn" id="MathJax-Span-299" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.242em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-47">s_1</script> 与 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-300" style="width: 1.079em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.682em 1000.82em 2.5em -999.998em); top: -2.237em; left: 0em;"><span class="mrow" id="MathJax-Span-301"><span class="msubsup" id="MathJax-Span-302"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px;"><span style="position: absolute; clip: rect(3.447em 1000.35em 4.137em -999.998em); top: -4.003em; left: 0em;"><span class="mi" id="MathJax-Span-303" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.39em;"><span class="mn" id="MathJax-Span-304" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.242em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-48">s_2</script>, 集合 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-305" style="width: 7.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.429em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.682em 1005.38em 2.845em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-306"><span class="mi" id="MathJax-Span-307" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-308" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-309" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-310" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-311" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-312" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-313" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-314" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.088em;"></span></span><span class="mo" id="MathJax-Span-315" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-316" style="padding-left: 0.174em;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px;"><span style="position: absolute; clip: rect(3.447em 1000.35em 4.137em -999.998em); top: -4.003em; left: 0em;"><span class="mi" id="MathJax-Span-317" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.39em;"><span class="mn" id="MathJax-Span-318" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-319" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>T</mi><mo>,</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">endpos(T, s_1)</script> 与 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-320" style="width: 7.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.429em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.682em 1005.38em 2.845em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-323" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-324" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-325" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-326" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-327" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-328" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-329" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.088em;"></span></span><span class="mo" id="MathJax-Span-330" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-331" style="padding-left: 0.174em;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px;"><span style="position: absolute; clip: rect(3.447em 1000.35em 4.137em -999.998em); top: -4.003em; left: 0em;"><span class="mi" id="MathJax-Span-332" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.39em;"><span class="mn" id="MathJax-Span-333" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-334" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>T</mi><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-50">endpos(T, s_2)</script> 的关系会是什么?</strong></p>

<p>For generality, 假设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-335" style="width: 11.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.29em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1009.25em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-338" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-339" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-340" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-341" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-342" style="font-family: STIXGeneral-Italic;">h</span><span class="mo" id="MathJax-Span-343" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-344"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-345" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-346" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-347" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-348" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">≤</span><span class="mi" id="MathJax-Span-349" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-350" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-351" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-352" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-353" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-354" style="font-family: STIXGeneral-Italic;">h</span><span class="mo" id="MathJax-Span-355" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-356"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-357" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-358" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-359" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>≤</mo><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-51">length(s_1) \leq length(s_2)</script>. 如果 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2205;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-360" style="width: 15.02em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.721em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.608em 1011.72em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-363" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-364" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-365" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-366" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-367" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-368" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-369"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-370" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-371" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-372" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-373" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">∩</span><span class="mi" id="MathJax-Span-374" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">e</span><span class="mi" id="MathJax-Span-375" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-376" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-377" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-378" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-379" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-380" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-381"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-382" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-383" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-384" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-385" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">≠</span><span class="mi" id="MathJax-Span-386" style="font-family: STIXVariants; padding-left: 0.306em;">∅</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>∩</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>≠</mo><mi mathvariant="normal">∅</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">endpos(s_1) \cap endpos(s_2) \neq \emptyset</script>, 也就是说, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-387" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-388"><span class="msubsup" id="MathJax-Span-389"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-390" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-391" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-53">s_1</script> 与 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-392" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-393"><span class="msubsup" id="MathJax-Span-394"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-395" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-396" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-54">s_2</script> 至少会同时以 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-397" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-398"><span class="mi" id="MathJax-Span-399" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">T</script> 某个字符作为结尾. 所以, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2205;&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-400" style="width: 22.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.45em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.608em 1017.45em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-401"><span class="mi" id="MathJax-Span-402" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-403" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-404" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-405" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-406" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-407" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-408" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-409"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-410" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-411" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-412" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-413" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">∩</span><span class="mi" id="MathJax-Span-414" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">e</span><span class="mi" id="MathJax-Span-415" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-416" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-417" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-418" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-419" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-420" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-421"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-422" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-423" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-424" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-425" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">≠</span><span class="mi" id="MathJax-Span-426" style="font-family: STIXVariants; padding-left: 0.306em;">∅</span><span class="mspace" id="MathJax-Span-427" style="height: 0em; vertical-align: 0em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-428" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⟹</span><span class="mspace" id="MathJax-Span-429" style="height: 0em; vertical-align: 0em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-430" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-431" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-432" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-433" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="msubsup" id="MathJax-Span-434" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-435" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-436" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>∩</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>≠</mo><mi mathvariant="normal">∅</mi><mspace width="thickmathspace"></mspace><mo stretchy="false">⟹</mo><mspace width="thickmathspace"></mspace><msub><mi>s</mi><mn>1</mn></msub><mo>⊐</mo><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-56">endpos(s_1) \cap endpos(s_2) \neq \emptyset \implies s_1 \sqsupset s_2</script>, 即 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-437" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-438"><span class="msubsup" id="MathJax-Span-439"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-440" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-441" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-57">s_1</script> 是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-442" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-443"><span class="msubsup" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-445" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-446" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">s_2</script> 的 suffix (注意, 包含 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-447" style="width: 3.778em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.954em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1002.95em 2.737em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-448"><span class="msubsup" id="MathJax-Span-449"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-450" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-451" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-452" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-453" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-454" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-455" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-59">s_1 = s_2</script> 的情况).</p>

<p>显然的, 如果 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-456" style="width: 3.778em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.954em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.825em 1002.95em 2.737em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-457"><span class="msubsup" id="MathJax-Span-458"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-459" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-460" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-461" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="msubsup" id="MathJax-Span-462" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-463" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-464" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub><mo>⊐</mo><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">s_1 \sqsupset s_2</script>, 则 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2287;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-465" style="width: 12.849em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.028em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1009.99em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-466"><span class="mi" id="MathJax-Span-467" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-468" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-469" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-470" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-471" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-472" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-473" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-474"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-475" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-476" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-477" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-478" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊇</span><span class="mi" id="MathJax-Span-479" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-480" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-481" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-482" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-483" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-484" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-485" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-486"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-487" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-488" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-489" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>⊇</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-61">endpos(s_1) \supseteq endpos(s_2) </script>, 毕竟 substring 越长, 对 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-490" style="width: 3.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.867em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.82em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-491"><span class="mi" id="MathJax-Span-492" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-493" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-494" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-495" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-496" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-497" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-62">endpos</script> 的限制就越多, 集合就越小. 再有, 如果 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2287;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-498" style="width: 12.849em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.028em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1009.99em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-501" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-502" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-503" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-504" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-505" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-506" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-507"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-508" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-509" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-510" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-511" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊇</span><span class="mi" id="MathJax-Span-512" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-513" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-514" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-515" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-516" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-517" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-518" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-519"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-520" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-521" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-522" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>⊇</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-63">endpos(s_1) \supseteq endpos(s_2)</script>, 则必有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-523" style="width: 11.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.29em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1009.25em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-524"><span class="mi" id="MathJax-Span-525" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-526" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-527" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-528" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-529" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-530" style="font-family: STIXGeneral-Italic;">h</span><span class="mo" id="MathJax-Span-531" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-532"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-533" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-534" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-535" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-536" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">≤</span><span class="mi" id="MathJax-Span-537" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-538" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-539" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-540" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-541" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-542" style="font-family: STIXGeneral-Italic;">h</span><span class="mo" id="MathJax-Span-543" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-544"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-545" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-546" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-547" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>≤</mo><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-64">length(s_1) \leq length(s_2)</script>, 由此可推导出 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-548" style="width: 3.778em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.954em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.825em 1002.95em 2.737em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-549"><span class="msubsup" id="MathJax-Span-550"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-551" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-552" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-553" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="msubsup" id="MathJax-Span-554" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-555" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-556" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub><mo>⊐</mo><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-65">s_1 \sqsupset s_2</script>. 综上, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2287;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x21D4;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-557" style="width: 18.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.542em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1014.54em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-558"><span class="mi" id="MathJax-Span-559" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-560" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-561" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-562" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-563" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-564" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-565" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-566"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-567" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-568" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-569" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-570" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊇</span><span class="mi" id="MathJax-Span-571" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-572" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-573" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-574" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-575" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-576" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-577" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-578"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-579" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-580" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-581" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-582" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⇔</span><span class="msubsup" id="MathJax-Span-583" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-584" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-585" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-586" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="msubsup" id="MathJax-Span-587" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-588" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-589" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>⊇</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">⇔</mo><msub><mi>s</mi><mn>1</mn></msub><mo>⊐</mo><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-66">endpos(s_1) \supseteq endpos(s_2) \Leftrightarrow s_1 \sqsupset s_2</script>.</p>

<p>所以, 我们现在可以回答上面提出的那个问题了:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2287;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;iff&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2205;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;otherwise&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-590" style="width: 23.396em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.275em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(2.259em 1018.27em 4.776em -999.998em); top: -3.774em; left: 0em;"><span class="mrow" id="MathJax-Span-591"><span class="mrow" id="MathJax-Span-592"><span class="mo" id="MathJax-Span-593" style="vertical-align: -0.475em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">{</span></span></span><span class="mtable" id="MathJax-Span-594" style="padding-right: 0.176em; padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 17.146em; height: 0px;"><span style="position: absolute; clip: rect(2.606em 1011.85em 4.993em -999.998em); top: -3.991em; left: 0em;"><span style="display: inline-block; position: relative; width: 11.895em; height: 0px;"><span style="position: absolute; clip: rect(3.171em 1010.2em 4.342em -999.998em); top: -4.555em; left: 0em;"><span class="mtd" id="MathJax-Span-595"><span class="mrow" id="MathJax-Span-596"><span class="mi" id="MathJax-Span-597" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-598" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-599" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-600" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-601" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-602" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-603" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-604"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-605" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-606" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-607" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-608" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊇</span><span class="mi" id="MathJax-Span-609" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-610" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-611" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-612" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-613" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-614" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-615" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-616"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-617" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-618" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-619" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-620" style="font-family: STIXGeneral-Regular;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; clip: rect(3.127em 1011.85em 4.342em -999.998em); top: -3.34em; left: 0em;"><span class="mtd" id="MathJax-Span-631"><span class="mrow" id="MathJax-Span-632"><span class="mi" id="MathJax-Span-633" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-634" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-635" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-636" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-637" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-638" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-639" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-640"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-641" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-642" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-643" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-644" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">∩</span><span class="mi" id="MathJax-Span-645" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">e</span><span class="mi" id="MathJax-Span-646" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-647" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-648" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-649" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-650" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-651" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-652"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-653" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-654" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-655" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-656" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-657" style="font-family: STIXVariants; padding-left: 0.306em;">∅</span><span class="mo" id="MathJax-Span-658" style="font-family: STIXGeneral-Regular;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; clip: rect(2.606em 1004.12em 4.82em -999.998em); top: -3.991em; left: 13.023em;"><span style="display: inline-block; position: relative; width: 4.125em; height: 0px;"><span style="position: absolute; clip: rect(3.171em 1004.12em 4.256em -999.998em); top: -4.555em; left: 0em;"><span class="mtd" id="MathJax-Span-621"><span class="mrow" id="MathJax-Span-622"><span class="mtext" id="MathJax-Span-623" style="font-family: STIXGeneral-Regular;">iff&nbsp;</span><span class="msubsup" id="MathJax-Span-624"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-625" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-626" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-627" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="msubsup" id="MathJax-Span-628" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-629" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-630" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; clip: rect(3.171em 1003.87em 4.125em -999.998em); top: -3.34em; left: 0em;"><span class="mtd" id="MathJax-Span-659"><span class="mrow" id="MathJax-Span-660"><span class="mtext" id="MathJax-Span-661" style="font-family: STIXGeneral-Regular;">otherwise</span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-662"></span></span></span><span style="display: inline-block; width: 0px; height: 3.778em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.164em; border-left: 0px solid; width: 0px; height: 2.947em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>⊇</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>,</mo></mtd><mtd><mtext>iff&nbsp;</mtext><msub><mi>s</mi><mn>1</mn></msub><mo>⊐</mo><msub><mi>s</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>∩</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∅</mi><mo>,</mo></mtd><mtd><mtext>otherwise</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-67">
\begin{cases}
endpos(s_1) \supseteq endpos(s_2),  & \text{iff } s_1 \sqsupset s_2 \\  
endpos(s_1) \cap endpos(s_2) = \emptyset, & \text{otherwise}  
\end{cases}
</script></p>

<p>让我们进一步来思考一个问题: <strong>给定一个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-663" style="width: 0.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.94em 1000.48em 2.629em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-664"><span class="mi" id="MathJax-Span-665" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-68">u</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-666" style="width: 6.893em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.342em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.682em 1005.3em 2.845em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-667"><span class="mi" id="MathJax-Span-668" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-669" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-670" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-671" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-672" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-673" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-674" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-675" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-676" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-677" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-678" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-679" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-680" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">substrings(u)</script> 有什么特性?</strong></p>

<p>给定一个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-681" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-682"><span class="mi" id="MathJax-Span-683" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">u</script>, 定义</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-684" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-685"><span class="mi" id="MathJax-Span-686" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-687" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-688" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-689" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-690" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-691" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-692" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-693" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-694" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-695" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-71">longest(u)</script>: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-696" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-697"><span class="mi" id="MathJax-Span-698" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-699" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-700" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-701" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-702" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-703" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-704" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-705" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-706" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-707" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-708" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-709" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-710" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-72">substrings(u)</script> 中最长的 substring</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-711" style="width: 5.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.386em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.34em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-712"><span class="mi" id="MathJax-Span-713" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-714" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-715" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-716" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-717" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-718" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-719" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-720" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-721" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-722" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-723" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>h</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-73">shortest(u)</script>: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-724" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-725"><span class="mi" id="MathJax-Span-726" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-727" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-728" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-729" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-730" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-731" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-732" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-733" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-734" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-735" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-736" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-737" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-738" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-74">substrings(u)</script> 中最短 substring</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-739" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-740"><span class="mi" id="MathJax-Span-741" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-742" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-743" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-744" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-745" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-746" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-747" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-748" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-749" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-75">maxlen(u)</script>: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-750" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-751"><span class="mi" id="MathJax-Span-752" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-753" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-754" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-755" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-756" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-757" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-758" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-759" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-760" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-761" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-76">longest(u)</script> 的长度</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-762" style="width: 5.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.908em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.87em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-763"><span class="mi" id="MathJax-Span-764" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-765" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-766" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-767" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-768" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-769" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-770" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-771" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-772" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-77">minlen(u)</script>: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-773" style="width: 5.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.386em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.34em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-774"><span class="mi" id="MathJax-Span-775" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-776" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-777" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-778" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-779" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-780" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-781" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-782" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-783" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-784" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-785" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>h</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-78">shortest(u)</script> 的长度</li>
</ul>

<p>由于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-786" style="width: 21.573em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.842em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1016.8em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-787"><span class="mi" id="MathJax-Span-788" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-789" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-790" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-791" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-792" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-793" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-794" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-795" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-796" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-797" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-798" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-799" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-800" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-801" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-802" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-803" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-804" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-805" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-806" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-807" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-808" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-809" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-810" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-811" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-812" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-813" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-814" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-815" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-816" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-817" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-818" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-819" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-820" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-821" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-822" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-823" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-824" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-825" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>h</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-79">endpos(shortest(u)) = endpos(longest(u))</script>, 根据上一个问题的结论, 我们可以知道 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-826" style="width: 12.459em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.724em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1009.68em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-827"><span class="mi" id="MathJax-Span-828" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-829" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-830" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-831" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-832" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-833" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-834" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-835" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-836" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-837" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-838" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-839" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="mi" id="MathJax-Span-840" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-841" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-842" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-843" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-844" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-845" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-846" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-847" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-848" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-849" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>h</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>⊐</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-80">shortest(u) \sqsupset longest(u)</script>. 同理, 对于任意的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-850" style="width: 9.29em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.25em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.21em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-851"><span class="msubsup" id="MathJax-Span-852"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-853" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-854" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-855" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-856" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-857" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-858" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-859" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-860" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-861" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-862" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-863" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-864" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-865" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-866" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-867" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-868" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>i</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-81">s_i \in substrings(u)</script>, 必有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-869" style="width: 7.684em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.95em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-870"><span class="msubsup" id="MathJax-Span-871"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-872" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-873" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-874" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="mi" id="MathJax-Span-875" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-876" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-877" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-878" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-879" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-880" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-881" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-882" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-883" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-884" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>i</mi></msub><mo>⊐</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-82">s_i \sqsupset longest(u)</script>, 也就是说, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-885" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-886"><span class="mi" id="MathJax-Span-887" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-888" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-889" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-890" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-891" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-892" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-893" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-894" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-895" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-896" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-897" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-898" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-899" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-83">substrings(u)</script> 中所有的 substrings, 必然会是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-900" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-901"><span class="mi" id="MathJax-Span-902" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-903" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-904" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-905" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-906" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-907" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-908" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-909" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-910" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-911" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-84">longest(u)</script> 的 suffix!</p>

<p>而且, 需要注意的是, 设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-912" style="width: 7.684em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.95em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-913"><span class="msubsup" id="MathJax-Span-914"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-915" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-916" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-917" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="mi" id="MathJax-Span-918" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-919" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-920" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-921" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-922" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-923" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-924" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-925" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-926" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-927" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>i</mi></msub><mo>⊐</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-85">s_i \sqsupset longest(u)</script> 且 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-928" style="width: 18.405em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.368em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1014.33em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-929"><span class="mi" id="MathJax-Span-930" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-931" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-932" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-933" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-934" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-935" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-936" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-937" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-938" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-939" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">≤</span><span class="mi" id="MathJax-Span-940" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-941" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-942" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-943" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-944" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-945" style="font-family: STIXGeneral-Italic;">h</span><span class="mo" id="MathJax-Span-946" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-947"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-948" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-949" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-950" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-951" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">≤</span><span class="mi" id="MathJax-Span-952" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-953" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-954" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-955" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-956" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-957" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-958" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-959" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-960" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>≤</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-86">minlen(u) \leq length(s_i) \leq  maxlen(u)</script>, 则必有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-961" style="width: 9.29em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.25em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.21em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-962"><span class="msubsup" id="MathJax-Span-963"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-964" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-965" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-966" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-967" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-968" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-969" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-970" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-971" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-972" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-973" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-974" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-975" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-976" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-977" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-978" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-979" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>i</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-87">s_i \in substrings(u)</script>. 证明很简单, 因为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2287;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2287;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-980" style="width: 28.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.311em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1022.27em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-981"><span class="mi" id="MathJax-Span-982" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-983" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-984" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-985" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-986" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-987" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-988" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-989" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-990" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-991" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-992" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-993" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-994" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-995" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-996" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-997" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-998" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-999" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1000" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1001" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊇</span><span class="mi" id="MathJax-Span-1002" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-1003" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1004" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1005" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-1006" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1007" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1008" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1009"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1010" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-1011" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1012" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1013" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊇</span><span class="mi" id="MathJax-Span-1014" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-1015" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1016" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1017" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-1018" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1019" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1020" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1021" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1022" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1023" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1024" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1025" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1026" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1027" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1028" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1029" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1030" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1031" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>h</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⊇</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>⊇</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-88">endpos(shortest(u)) \supseteq endpos(s_i) \supseteq endpos(longest(u))</script>, 由于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1032" style="width: 21.573em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.842em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1016.8em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1033"><span class="mi" id="MathJax-Span-1034" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1035" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1036" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1037" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-1038" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1039" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1040" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1041" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1042" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-1043" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1044" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1045" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1046" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1047" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1048" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1049" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1050" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1051" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1052" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1053" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1054" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-1055" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1056" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1057" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-1058" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1059" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1060" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1061" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1062" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1063" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1064" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1065" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1066" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1067" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1068" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1069" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1070" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1071" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>h</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-89">endpos(shortest(u)) = endpos(longest(u))</script>, 所以 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1072" style="width: 9.29em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.25em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.21em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1073"><span class="msubsup" id="MathJax-Span-1074"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1075" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-1076" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1077" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-1078" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-1079" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1080" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1081" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1082" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1083" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1084" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1085" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1086" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1087" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1088" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1089" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1090" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>i</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-90">s_i \in substrings(u)</script>, 得证.</p>

<p>直观来讲, 这意味这一个 state 会对应一个"连续的" suffix 集合, 例如 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1091" style="width: 3.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.867em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.78em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1092"><span class="mo" id="MathJax-Span-1093" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1094" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1095" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1096" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-1097" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>"</mo><mi>a</mi><mi>b</mi><mi>c</mi><mo>"</mo></math></span></span><script type="math/tex" id="MathJax-Element-91">"abc"</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1098" style="width: 3.084em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.389em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.3em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1099"><span class="mo" id="MathJax-Span-1100" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1101" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mi" id="MathJax-Span-1102" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-1103" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>"</mo><mi>b</mi><mi>c</mi><mo>"</mo></math></span></span><script type="math/tex" id="MathJax-Element-92">"bc"</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1104" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.78em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1105"><span class="mo" id="MathJax-Span-1106" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1107" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mo" id="MathJax-Span-1108" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>"</mo><mi>c</mi><mo>"</mo></math></span></span><script type="math/tex" id="MathJax-Element-93">"c"</script>, 每个 substring 恰好是上一个 substring 的 suffix, 长度与上一个 substring 相差 1. 这真是一个美妙的特性呢!</p>

<h2 id="statessuffixlink">State's Suffix Link</h2>

<p>除了通过 symbol (字符), SAM 的 state 之间还有另外一种状态变化方式, 也就是 suffix link. 上个小节谈到,  给定一个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1109" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1110"><span class="mi" id="MathJax-Span-1111" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-94">u</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1112" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1113"><span class="mi" id="MathJax-Span-1114" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1115" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1116" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1117" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1118" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1119" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1120" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1121" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1122" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1123" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1124" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1125" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1126" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-95">substrings(u)</script> 可以通过 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1127" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1128"><span class="mi" id="MathJax-Span-1129" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1130" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1131" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1132" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1133" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1134" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1135" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1136" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1137" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1138" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-96">longest(u)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1139" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1140"><span class="mi" id="MathJax-Span-1141" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-1142" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1143" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1144" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1145" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1146" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-1147" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1148" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1149" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-97">maxlen(u)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1150" style="width: 5.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.386em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.34em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1151"><span class="mi" id="MathJax-Span-1152" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1153" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-1154" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1155" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1156" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1157" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1158" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1159" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1160" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1161" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1162" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>h</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-98">shortest(u)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1163" style="width: 5.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.908em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.87em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1164"><span class="mi" id="MathJax-Span-1165" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-1166" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1167" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1168" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1169" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1170" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-1171" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1172" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1173" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-99">minlen(u)</script> 描述, 而且 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1174" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1175"><span class="mi" id="MathJax-Span-1176" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1177" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1178" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1179" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1180" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1181" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1182" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1183" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1184" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1185" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1186" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1187" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1188" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-100">substrings(u)</script> 是"连续"的. 我们将基于上述结论定义 suffix link.</p>

<p>给定 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1189" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1190"><span class="mi" id="MathJax-Span-1191" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">u</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1192" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1193"><span class="mi" id="MathJax-Span-1194" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-102">v</script>, 定义 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1195" style="width: 5.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.386em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.34em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1196"><span class="mi" id="MathJax-Span-1197" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-1198" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1199" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1200" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1201" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1202" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1203" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1204" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1205" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo>=</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-103">v = link(u)</script>, 意为存在 from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1206" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1207"><span class="mi" id="MathJax-Span-1208" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-104">u</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1209" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1210"><span class="mi" id="MathJax-Span-1211" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">v</script> 的 suffix link, 其中 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1212" style="width: 13.978em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.896em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1010.85em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1213"><span class="mi" id="MathJax-Span-1214" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-1215" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1216" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1217" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1218" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1219" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-1220" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1221" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-1222" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1223" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-1224" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-1225" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1226" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-1227" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1228" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1229" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1230" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1231" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-1232" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1233" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1234" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-106">maxlen(v) + 1 = minlen(u)</script>. 例如, 对于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1235" style="width: 6.426em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.993em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.91em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1236"><span class="mi" id="MathJax-Span-1237" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-1238" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mi" id="MathJax-Span-1239" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1240" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1241" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-1242" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1243" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>="</mo><mi>a</mi><mi>b</mi><mi>c</mi><mi>b</mi><mo>"</mo></math></span></span><script type="math/tex" id="MathJax-Element-107">T = "abcb"</script>, 有如下的 SAM 结构:</p>

<p><img src="./SAM_files/abcb[Fp44MnZpw2P9qnKVU8NLu3uHtrCJ].png" alt="abcb[Fp44MnZpw2P9qnKVU8NLu3uHtrCJ].png" title=""></p>

<p>可以看到, 相比于之前的图例, 上图中加入了蓝色的 edges, 这些蓝色的 edges 就是 suffix links. 同时, 在图例中的每个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1244" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1245"><span class="mi" id="MathJax-Span-1246" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-108">u</script> 里标记了 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1247" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1248"><span class="mi" id="MathJax-Span-1249" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1250" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1251" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1252" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1253" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1254" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1255" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1256" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1257" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1258" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-109">longest(u)</script> 与 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1259" style="width: 5.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.386em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.34em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1260"><span class="mi" id="MathJax-Span-1261" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1262" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-1263" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1264" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1265" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1266" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1267" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1268" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1269" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1270" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1271" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>h</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-110">shortest(u)</script>, 以方便理解. 在上图中可以看到, state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1272" style="width: 8.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.816em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.73em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1273"><span class="mo" id="MathJax-Span-1274" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1275" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1276" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1277" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1278" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-1279" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1280" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1281" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1282" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1283" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mi" id="MathJax-Span-1284" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1285" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1286" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>"</mo><mi>a</mi><mi>b</mi><mi>c</mi><mi>b</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>c</mi><mi>b</mi><mo>"</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-111">["abcb", "cb"]</script> (也就是最右边的 state) 通过 suffix link 指向 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1287" style="width: 6.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.95em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.86em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1288"><span class="mo" id="MathJax-Span-1289" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1290" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1291" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mo" id="MathJax-Span-1292" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1293" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1294" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1295" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mo" id="MathJax-Span-1296" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1297" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>"</mo><mi>b</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>b</mi><mo>"</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-112">["b", "b"]</script>, state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1298" style="width: 6.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.95em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.86em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1299"><span class="mo" id="MathJax-Span-1300" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1301" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1302" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mo" id="MathJax-Span-1303" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1304" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1305" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1306" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mo" id="MathJax-Span-1307" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1308" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>"</mo><mi>b</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>b</mi><mo>"</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-113">["b", "b"]</script> 再通过 suffix link 指向 start state. 其中,  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1309" style="width: 27.78em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.704em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1021.66em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1310"><span class="mi" id="MathJax-Span-1311" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-1312" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1313" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1314" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1315" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1316" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-1317" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-1318" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1319" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1320" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mo" id="MathJax-Span-1321" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1322" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1323" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1324" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mo" id="MathJax-Span-1325" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1326" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-1327" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1328" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-1329" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-1330" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1331" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-1332" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1333" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1334" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1335" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1336" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-1337" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-1338" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1339" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1340" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1341" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1342" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-1343" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1344" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1345" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1346" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1347" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mi" id="MathJax-Span-1348" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1349" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1350" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-1351" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mo>"</mo><mi>b</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>b</mi><mo>"</mo><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mo>"</mo><mi>a</mi><mi>b</mi><mi>c</mi><mi>b</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>c</mi><mi>b</mi><mo>"</mo><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-114">maxlen(["b", "b"]) + 1 = minlen(["abcb", "cb"])</script>.</p>

<p>为了简化表述, 引入以下与 suffix link 相关的符号与术语:</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1352" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1000.83em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-1353"><span class="msubsup" id="MathJax-Span-1354"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1355" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-1356" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-115">T_i</script>: 表示 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1357" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1358"><span class="mi" id="MathJax-Span-1359" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-116">T</script> 中以 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1360" style="width: 2.086em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.608em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1001.52em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1361"><span class="mi" id="MathJax-Span-1362" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-1363" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-1364" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-1365" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-117">T[i]</script> 结尾的 prefix.</li>
<li><strong>Suffix-link path</strong> from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1366" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1367"><span class="mi" id="MathJax-Span-1368" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">u</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1369" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1370"><span class="mi" id="MathJax-Span-1371" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-119">v</script>: 从 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1372" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1373"><span class="mi" id="MathJax-Span-1374" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">u</script> 到 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1375" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1376"><span class="mi" id="MathJax-Span-1377" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-121">v</script> 的, 一条使用 suffix link 相连的路径.</li>
</ul>

<p>直观来讲, SAM 会把 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1378" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1000.83em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-1379"><span class="msubsup" id="MathJax-Span-1380"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1381" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-1382" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-122">T_i</script> 的 suffix 集合 (注意, 我这里用的不是 substring) <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1383" style="width: 3.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.737em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.65em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1384"><span class="mo" id="MathJax-Span-1385" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1386" style="font-family: STIXGeneral-Regular;">"<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mo" id="MathJax-Span-1387" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1388" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1389" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-1390" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1391" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>""</mo><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-123">["", T_i]</script> 切成几个区间, 每个区间可以视为一个 state, state 之间使用 suffix link 连接. 所以, 对于某个满足 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1392" style="width: 7.901em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.165em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.16em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1393"><span class="mi" id="MathJax-Span-1394" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1395" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1396" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1397" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1398" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1399" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1400" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1401" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1402" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1403" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1404" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-1405" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1406" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-1407" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-124">longest(u) = T_i</script> 的 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1408" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1409"><span class="mi" id="MathJax-Span-1410" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">u</script> , 考虑 suffix-link path from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1411" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1412"><span class="mi" id="MathJax-Span-1413" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-126">u</script> to start state 上的所有 states, 对这些 states 对应的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1414" style="width: 5.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.12em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1415"><span class="mi" id="MathJax-Span-1416" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1417" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1418" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1419" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1420" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1421" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1422" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1423" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1424" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1425" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-127">substrings</script> 集合做 union 操作, 即可得到 suffix 集合 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1426" style="width: 3.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.737em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.65em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1427"><span class="mo" id="MathJax-Span-1428" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1429" style="font-family: STIXGeneral-Regular;">"<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mo" id="MathJax-Span-1430" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1431" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1432" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-1433" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1434" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>""</mo><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-128">["", T_i]</script>. 以下是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1435" style="width: 11.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.9em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.81em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1436"><span class="mi" id="MathJax-Span-1437" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1438" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-1439" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1440" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1441" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-1442" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1443" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1444" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1445" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1446" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1447" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mi" id="MathJax-Span-1448" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1449" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1450" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-1451" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1452" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-1453" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>="</mo><mi>a</mi><mi>b</mi><mi>c</mi><mi>d</mi><mi>e</mi><mo>"</mo></math></span></span><script type="math/tex" id="MathJax-Element-129">longest(u) = "abcde"</script> 的图例:</p>

<p><img src="./SAM_files/suffix-link.png" alt="suffix-link.png"></p>

<p>可以看到,  suffix 集合 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1454" style="width: 7.424em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.775em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.69em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1455"><span class="mo" id="MathJax-Span-1456" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1457" style="font-family: STIXGeneral-Regular;">"<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mo" id="MathJax-Span-1458" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1459" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1460" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1461" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1462" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-1463" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1464" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-1465" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1466" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>""</mo><mo>,</mo><mo>"</mo><mi>a</mi><mi>b</mi><mi>c</mi><mi>d</mi><mi>e</mi><mo>"</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-130">["", "abcde"]</script> 被划分成 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1467" style="width: 3.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.737em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.65em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1468"><span class="mo" id="MathJax-Span-1469" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1470" style="font-family: STIXGeneral-Regular;">"<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mo" id="MathJax-Span-1471" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1472" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mo" id="MathJax-Span-1473" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>""</mo><mo>,</mo><mo>""</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-131">["", ""]</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1474" style="width: 6.165em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.82em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.73em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1475"><span class="mo" id="MathJax-Span-1476" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1477" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1478" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mo" id="MathJax-Span-1479" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1480" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1481" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1482" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mo" id="MathJax-Span-1483" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1484" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>"</mo><mi>e</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>e</mi><mo>"</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-132">["e", "e"]</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1485" style="width: 8.118em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.339em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.25em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1486"><span class="mo" id="MathJax-Span-1487" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1488" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1489" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1490" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-1491" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1492" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1493" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1494" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mi" id="MathJax-Span-1495" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1496" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-1497" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1498" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>"</mo><mi>d</mi><mi>e</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>c</mi><mi>d</mi><mi>e</mi><mo>"</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-133">["de", "cde"]</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1499" style="width: 10.636em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.292em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.21em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1500"><span class="mo" id="MathJax-Span-1501" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1502" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1503" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mi" id="MathJax-Span-1504" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-1505" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1506" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-1507" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1508" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1509" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1510" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1511" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1512" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-1513" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1514" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-1515" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1516" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>"</mo><mi>b</mi><mi>c</mi><mi>d</mi><mi>e</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>a</mi><mi>b</mi><mi>c</mi><mi>d</mi><mi>e</mi><mo>"</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-134">["bcde", "abcde"]</script> 4 个区间, 其间通过 suffix link 相连.</p>

<h2 id="statestransitions">State's Transitions</h2>

<p>现在我们来深入探讨一下 SAM 里面的 state transition 的含义. 需要注意的是, <em>就 DFA 的定义而言</em>, suffix link 与 state transition 是没有关系的, 原因是 suffix link 并没有被 symbol labeled, 这不符合 DFA 里 <em>transition function</em> 的定义. 这也是为什么我在上一小节使用"<em>状态变化</em>"来描述 suffix link, 因为 suffix link 并不是"<em>状态转移</em>". (但在 SAM 的结构里两者是有关系的, 本小节会讨论这一关系)</p>

<p>给定一个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1517" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1518"><span class="mi" id="MathJax-Span-1519" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-135">u</script> 与 symbol <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1520" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1521"><span class="mi" id="MathJax-Span-1522" style="font-family: STIXGeneral-Italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-136">c</script>, 定义 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1523" style="width: 7.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.86em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1524"><span class="mi" id="MathJax-Span-1525" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1526" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1527" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1528" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1529" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1530" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1531" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1532" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1533" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">c</span><span class="mo" id="MathJax-Span-1534" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1535" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1536" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-137">trans(u, c) = v</script>, 表示从 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1537" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1538"><span class="mi" id="MathJax-Span-1539" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-138">u</script> 到 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1540" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1541"><span class="mi" id="MathJax-Span-1542" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-139">v</script> 存在 state transition 路径, 该路径通过 symbol <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1543" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1544"><span class="mi" id="MathJax-Span-1545" style="font-family: STIXGeneral-Italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-140">c</script> 标识. 在本文的图例中, state transition 一律使用黑色的 edge 表示.</p>

<p>为了深入理解 SAM state transition 的含义, 需要思考一个问题: <strong>如果存在 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1546" style="width: 7.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.859em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.682em 1005.86em 2.801em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-1547"><span class="mi" id="MathJax-Span-1548" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1549" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-1550" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1551" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1552" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1553" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1554" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1555" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1556" style="font-family: STIXGeneral-Italic; padding-left: 0.174em;">c</span><span class="mo" id="MathJax-Span-1557" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1558" style="font-family: STIXGeneral-Regular; padding-left: 0.304em;">=</span><span class="mi" id="MathJax-Span-1559" style="font-family: STIXGeneral-Italic; padding-left: 0.304em;">v</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-141">trans(u, c) = v</script>, state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1560" style="width: 0.562em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.94em 1000.43em 2.629em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-1561"><span class="mi" id="MathJax-Span-1562" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-142">v</script> 与 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1563" style="width: 0.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.94em 1000.48em 2.629em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-1564"><span class="mi" id="MathJax-Span-1565" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-143">u</script> 有什么关系?</strong></p>

<p>由于有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1566" style="width: 7.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.86em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1567"><span class="mi" id="MathJax-Span-1568" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1569" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1570" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1571" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1572" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1573" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1574" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1575" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1576" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">c</span><span class="mo" id="MathJax-Span-1577" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1578" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1579" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-144">trans(u, c) = v</script>, 那么必有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mo&gt;&amp;#x2286;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1580" style="width: 23.006em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.971em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1017.93em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1581"><span class="mo" id="MathJax-Span-1582" style="font-family: STIXGeneral-Regular;">{</span><span class="msubsup" id="MathJax-Span-1583"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1584" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-1585" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1586" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mi" id="MathJax-Span-1587" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">c</span><span class="mo" id="MathJax-Span-1588" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∣</span><span class="msubsup" id="MathJax-Span-1589" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1590" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-1591" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1592" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-1593" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-1594" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1595" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1596" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1597" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1598" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1599" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1600" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1601" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1602" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1603" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1604" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1605" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1606" style="font-family: STIXGeneral-Regular;">}</span><span class="mo" id="MathJax-Span-1607" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊆</span><span class="mi" id="MathJax-Span-1608" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-1609" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1610" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1611" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1612" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1613" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1614" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1615" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1616" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1617" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1618" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1619" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-1620" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><mi>c</mi><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">}</mo><mo>⊆</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-145">\{ s_i + c \mid s_i \in substrings(u) \} \subseteq substrings(v)</script>, 也就是说, 往 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1621" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1622"><span class="mi" id="MathJax-Span-1623" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-146">u</script> 的对应的 substrings 后面拼接 symbol <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1624" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1625"><span class="mi" id="MathJax-Span-1626" style="font-family: STIXGeneral-Italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">c</script>, 得到的新 substrings 集合必然包含于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1627" style="width: 6.73em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.254em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.21em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1628"><span class="mi" id="MathJax-Span-1629" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1630" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1631" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1632" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1633" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1634" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1635" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1636" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1637" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1638" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1639" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1640" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-1641" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-148">substrings(v)</script>.</p>

<p>而且, 考虑到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1642" style="width: 6.73em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.254em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.21em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1643"><span class="mi" id="MathJax-Span-1644" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1645" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1646" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1647" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1648" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1649" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1650" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1651" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1652" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1653" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1654" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1655" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-1656" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-149">substrings(v)</script> 里的 substring 都是以某个 symbol <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1657" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1658"><span class="mi" id="MathJax-Span-1659" style="font-family: STIXGeneral-Italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-150">c</script> 结尾的, 我们可以知道, 对于 SAM 里所有合法的 state transitions <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1660" style="width: 8.249em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.426em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.43em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1661"><span class="mi" id="MathJax-Span-1662" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1663" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1664" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1665" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1666" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1667" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1668"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1669" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.523em;"><span class="mi" id="MathJax-Span-1670" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1671" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1672" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 0.697em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.44em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1673" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.436em;"><span class="mi" id="MathJax-Span-1674" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1675" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1676" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1677" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-151">trans(u_i, c_i) = v</script>, 必有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1678" style="width: 3.127em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.433em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1002.43em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1679"><span class="msubsup" id="MathJax-Span-1680"><span style="display: inline-block; position: relative; width: 0.697em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.44em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1681" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.436em;"><span class="mi" id="MathJax-Span-1682" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1683" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1684" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-152">c_i = c</script>, 也就是说, 所有以 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1685" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1686"><span class="mi" id="MathJax-Span-1687" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-153">v</script> 为终点的 transition , 必然带有相同的 symbol!</p>

<p>我们现在来考虑 indegrees <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1688" style="width: 1.912em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.478em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.39em 2.693em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1689"><span class="mo" id="MathJax-Span-1690" style="font-family: STIXGeneral-Regular;">≥</span><span class="mn" id="MathJax-Span-1691" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.164em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-154">\geq 1</script> 的情况, 还是以 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1692" style="width: 6.426em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.993em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.91em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1693"><span class="mi" id="MathJax-Span-1694" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-1695" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mi" id="MathJax-Span-1696" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1697" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1698" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-1699" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1700" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>="</mo><mi>a</mi><mi>b</mi><mi>c</mi><mi>b</mi><mo>"</mo></math></span></span><script type="math/tex" id="MathJax-Element-155">T = "abcb"</script> 为例:</p>

<p><img src="./SAM_files/trans.png" alt="trans.png"></p>

<p>在上图中, 设</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1701" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.782em 1001.87em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1702"><span class="mi" id="MathJax-Span-1703" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1704" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1705" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1706" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1707" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-156">start</script>: start state, 等价于 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1708" style="width: 3.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.737em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.65em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1709"><span class="mo" id="MathJax-Span-1710" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1711" style="font-family: STIXGeneral-Regular;">"<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mo" id="MathJax-Span-1712" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1713" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mo" id="MathJax-Span-1714" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>""</mo><mo>,</mo><mo>""</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-157">["", ""]</script> (最左, green 标记)</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1715" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-1716"><span class="msubsup" id="MathJax-Span-1717"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1718" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-1719" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-158">s_1</script>: state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1720" style="width: 6.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.95em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.86em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1721"><span class="mo" id="MathJax-Span-1722" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1723" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1724" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mo" id="MathJax-Span-1725" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1726" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1727" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1728" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">b</span><span class="mo" id="MathJax-Span-1729" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1730" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>"</mo><mi>b</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>b</mi><mo>"</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-159">["b", "b"]</script> (green 标记)</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1731" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.52em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-1732"><span class="msubsup" id="MathJax-Span-1733"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1734" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-1735" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-160">s_2</script>: state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1736" style="width: 7.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.948em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.86em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1737"><span class="mo" id="MathJax-Span-1738" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1739" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1740" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1741" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1742" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1743" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1744" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1745" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1746" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-1747" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1748" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>"</mo><mi>a</mi><mi>b</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>a</mi><mi>b</mi><mo>"</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-161">["ab", "ab"]</script>  (green 标记)</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1749" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1750"><span class="mi" id="MathJax-Span-1751" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-162">v</script>: state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1752" style="width: 7.467em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.818em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.73em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1753"><span class="mo" id="MathJax-Span-1754" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-1755" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1756" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mo" id="MathJax-Span-1757" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1758" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1759" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1760" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-1761" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1762" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-1763" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1764" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>"</mo><mi>c</mi><mo>"</mo><mo>,</mo><mo>"</mo><mi>a</mi><mi>b</mi><mi>c</mi><mo>"</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-163">["c", "abc"]</script> (red 标记)</li>
</ul>

<p>所以, 有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1765" style="width: 29.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.049em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1023.05em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1766"><span class="mi" id="MathJax-Span-1767" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1768" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1769" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1770" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1771" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1772" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1773" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1774" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1775" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1776" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1777" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1778" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1779" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1780" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mo" id="MathJax-Span-1781" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1782" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1783" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1784" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1785" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1786" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1787" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1788" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1789" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1790"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1791" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-1792" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1793" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1794" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1795" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mo" id="MathJax-Span-1796" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1797" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1798" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1799" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1800" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1801" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1802" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1803" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1804" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1805"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1806" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-1807" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1808" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1809" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">"</span><span class="mi" id="MathJax-Span-1810" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mo" id="MathJax-Span-1811" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span><span class="mo" id="MathJax-Span-1812" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1813" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1814" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mo>,</mo><mo>"</mo><mi>c</mi><mo>"</mo><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><mo>"</mo><mi>c</mi><mo>"</mo><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo>,</mo><mo>"</mo><mi>c</mi><mo>"</mo><mo stretchy="false">)</mo><mo>=</mo><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-164">trans(start, "c") = trans(s_1, "c") = trans(s_2, "c") = v</script>. 可以看到, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1815" style="width: 6.73em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.254em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.21em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1816"><span class="mi" id="MathJax-Span-1817" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1818" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1819" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1820" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1821" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1822" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1823" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1824" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1825" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1826" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1827" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1828" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-1829" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-165">substrings(v)</script> 其实就是往集合 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1830" style="width: 25.957em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.271em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1020.23em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1831"><span class="mi" id="MathJax-Span-1832" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1833" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1834" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1835" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1836" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1837" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1838" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1839" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1840" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1841" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1842" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1843" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1844" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1845" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1846" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1847" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1848" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1849" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">∪</span><span class="mi" id="MathJax-Span-1850" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">s</span><span class="mi" id="MathJax-Span-1851" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1852" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1853" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1854" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1855" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1856" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1857" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1858" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1859" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1860" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1861"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1862" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-1863" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1864" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1865" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">∪</span><span class="mi" id="MathJax-Span-1866" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">s</span><span class="mi" id="MathJax-Span-1867" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1868" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1869" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1870" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1871" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1872" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1873" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1874" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1875" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1876" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1877"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1878" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-1879" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1880" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mo stretchy="false">)</mo><mo>∪</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>∪</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-166">substrings(start) \cup substrings(s_1) \cup substrings(s_2)</script> 的所有 substrings 末尾拼接上 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1881" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.78em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1882"><span class="mo" id="MathJax-Span-1883" style="font-family: STIXGeneral-Regular;">"</span><span class="mi" id="MathJax-Span-1884" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mo" id="MathJax-Span-1885" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>"</mo><mi>c</mi><mo>"</mo></math></span></span><script type="math/tex" id="MathJax-Element-167">"c"</script> 之后得到的新集合! 由此可以引申得到以下性质:</p>

<p>对于 SAM 里的 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1886" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1887"><span class="mi" id="MathJax-Span-1888" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-168">v</script>, 设 transition symbol 为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1889" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1890"><span class="mi" id="MathJax-Span-1891" style="font-family: STIXGeneral-Italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-169">c</script>, 则有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1892" style="width: 31.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.829em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1024.74em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1893"><span class="mi" id="MathJax-Span-1894" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1895" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1896" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1897" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1898" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1899" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1900" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1901" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1902" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1903" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1904" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1905" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-1906" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1907" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-1908" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">{</span><span class="msubsup" id="MathJax-Span-1909"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1910" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-1911" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1912" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mi" id="MathJax-Span-1913" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">c</span><span class="mo" id="MathJax-Span-1914" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∣</span><span class="msubsup" id="MathJax-Span-1915" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1916" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-1917" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1918" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-1919" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-1920" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1921" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1922" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1923" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1924" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1925" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1926" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1927" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1928" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1929" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1930"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1931" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.523em;"><span class="mi" id="MathJax-Span-1932" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1933" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1934" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1935" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1936" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1937" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1938" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1939" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1940" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1941"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-1942" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.523em;"><span class="mi" id="MathJax-Span-1943" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-1944" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1945" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">c</span><span class="mo" id="MathJax-Span-1946" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1947" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1948" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">v</span><span class="mo" id="MathJax-Span-1949" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false" stretchy="false">{</mo><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><mi>c</mi><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>,</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mi>v</mi><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-170">substrings(v) = \{ s_i + c \mid s_i \in substrings(u_i), trans(u_i, c) = v \}</script>. 通俗来讲, 可以通过观察 state transitions 得到 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1950" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1951"><span class="mi" id="MathJax-Span-1952" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-171">v</script> 的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1953" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-1954"><span class="mi" id="MathJax-Span-1955" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1956" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-1957" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-1958" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-1959" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1960" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-1961" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-1962" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1963" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-1964" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1965" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1966" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-1967" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-172">substrings(u)</script>.</p>

<p>那么问题来了: <strong>设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1968" style="width: 14.386em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.156em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.682em 1011.07em 2.801em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-1969"><span class="msubsup" id="MathJax-Span-1970"><span style="display: inline-block; position: relative; width: 1.122em; height: 0px;"><span style="position: absolute; clip: rect(3.232em 1000.78em 4.137em -999.998em); top: -4.003em; left: 0em;"><span class="mi" id="MathJax-Span-1971" style="font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.734em;"><span class="mi" id="MathJax-Span-1972" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1973" style="font-family: STIXGeneral-Regular; padding-left: 0.304em;">=</span><span class="mo" id="MathJax-Span-1974" style="font-family: STIXGeneral-Regular; padding-left: 0.304em;">{</span><span class="msubsup" id="MathJax-Span-1975"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.447em 1000.48em 4.137em -999.998em); top: -4.003em; left: 0em;"><span class="mi" id="MathJax-Span-1976" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.519em;"><span class="mi" id="MathJax-Span-1977" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1978" style="font-family: STIXGeneral-Regular; padding-left: 0.304em;">∣</span><span class="mi" id="MathJax-Span-1979" style="font-family: STIXGeneral-Italic; padding-left: 0.304em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1980" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-1981" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1982" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-1983" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1984" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1985"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.447em 1000.48em 4.137em -999.998em); top: -4.003em; left: 0em;"><span class="mi" id="MathJax-Span-1986" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.519em;"><span class="mi" id="MathJax-Span-1987" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1988" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1989" style="font-family: STIXGeneral-Italic; padding-left: 0.174em;">c</span><span class="mo" id="MathJax-Span-1990" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1991" style="font-family: STIXGeneral-Regular; padding-left: 0.304em;">=</span><span class="mi" id="MathJax-Span-1992" style="font-family: STIXGeneral-Italic; padding-left: 0.304em;">v</span><span class="mo" id="MathJax-Span-1993" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>U</mi><mi>v</mi></msub><mo>=</mo><mo fence="false" stretchy="false">{</mo><msub><mi>u</mi><mi>i</mi></msub><mo>∣</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mi>v</mi><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-173">U_v = \{ u_i \mid trans(u_i, c) = v \}</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1994" style="width: 1.466em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.122em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.466em 1001.12em 2.543em -999.998em); top: -2.237em; left: 0em;"><span class="mrow" id="MathJax-Span-1995"><span class="msubsup" id="MathJax-Span-1996"><span style="display: inline-block; position: relative; width: 1.122em; height: 0px;"><span style="position: absolute; clip: rect(3.232em 1000.78em 4.137em -999.998em); top: -4.003em; left: 0em;"><span class="mi" id="MathJax-Span-1997" style="font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.734em;"><span class="mi" id="MathJax-Span-1998" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.242em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>U</mi><mi>v</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-174">U_v</script> 中的 states 有什么关系呢?</strong> </p>

<p>我们已经知道, 对于一个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1999" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2000"><span class="mi" id="MathJax-Span-2001" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-175">v</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2002" style="width: 6.73em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.254em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.21em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2003"><span class="mi" id="MathJax-Span-2004" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2005" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2006" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2007" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2008" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2009" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2010" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2011" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2012" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-2013" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2014" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2015" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-2016" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-176">substrings(v)</script> 中的 substrings 是"连续的". 由于到 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2017" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2018"><span class="mi" id="MathJax-Span-2019" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-177">v</script> 的 transition 都带有相同的 symbol <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2020" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2021"><span class="mi" id="MathJax-Span-2022" style="font-family: STIXGeneral-Italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-178">c</script>, 那么 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2023" style="width: 17.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.674em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1013.59em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2024"><span class="mo" id="MathJax-Span-2025" style="font-family: STIXGeneral-Regular;">{</span><span class="msubsup" id="MathJax-Span-2026"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2027" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-2028" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2029" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∣</span><span class="msubsup" id="MathJax-Span-2030" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2031" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-2032" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2033" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-2034" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-2035" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2036" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2037" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2038" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2039" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2040" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2041" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2042" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-2043" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2044" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2045"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2046" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.523em;"><span class="mi" id="MathJax-Span-2047" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2048" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2049" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-2050" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2051" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.523em;"><span class="mi" id="MathJax-Span-2052" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2053" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="msubsup" id="MathJax-Span-2054" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 1.131em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.78em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2055" style="font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.74em;"><span class="mi" id="MathJax-Span-2056" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2057" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>s</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>,</mo><msub><mi>u</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>U</mi><mi>v</mi></msub><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-179">\{ s_i \mid s_i \in substrings(u_i), u_i \in U_v \}</script> 必然也是"连续的".</p>

<p>回想一下上一小节的 suffix link 定义, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2058" style="width: 23.179em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.101em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1018.06em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2059"><span class="mi" id="MathJax-Span-2060" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-2061" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2062" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2063" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2064" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2065" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2066" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2067" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2068" style="font-family: STIXGeneral-Regular;">)</span><span class="mspace" id="MathJax-Span-2069" style="height: 0em; vertical-align: 0em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2070" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⟹</span><span class="mspace" id="MathJax-Span-2071" style="height: 0em; vertical-align: 0em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-2072" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-2073" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2074" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2075" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2076" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2077" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2078" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2079" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-2080" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2081" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2082" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2083" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2084" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-2085" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2086" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2087" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2088" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2089" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2090" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2091" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2092" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo>=</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo stretchy="false">⟹</mo><mspace width="thickmathspace"></mspace><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-180">v = link(u) \implies maxlen(v) + 1 = minlen(u)</script>, 我们可以知道, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2093" style="width: 1.478em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.131em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1001.13em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2094"><span class="msubsup" id="MathJax-Span-2095"><span style="display: inline-block; position: relative; width: 1.131em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.78em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2096" style="font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.74em;"><span class="mi" id="MathJax-Span-2097" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>U</mi><mi>v</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-181">U_v</script> 中的 states, 必然形成一条 <strong>suffix-link path</strong>! 以上图为例, 有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2098" style="width: 9.941em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.771em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.68em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2099"><span class="msubsup" id="MathJax-Span-2100"><span style="display: inline-block; position: relative; width: 1.131em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.78em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2101" style="font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.74em;"><span class="mi" id="MathJax-Span-2102" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2103" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-2104" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">{</span><span class="mi" id="MathJax-Span-2105" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2106" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2107" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2108" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2109" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2110" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-2111" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2112" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-2113" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2114" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-2115" style="padding-left: 0.176em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2116" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-2117" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2118" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>U</mi><mi>v</mi></msub><mo>=</mo><mo fence="false" stretchy="false">{</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mo>,</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-182">U_v = \{ start, s_1, s_2 \}</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2119" style="width: 7.901em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.165em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.12em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2120"><span class="mi" id="MathJax-Span-2121" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2122" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2123" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2124" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2125" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2126" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2127" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2128" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2129" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2130" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2131" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2132"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2133" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-2134" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2135" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mo>=</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-183">start = link(s_1)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2136" style="width: 6.556em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.124em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.08em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2137"><span class="msubsup" id="MathJax-Span-2138"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2139" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-2140" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2141" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2142" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2143" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2144" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2145" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2146" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2147"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2148" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mn" id="MathJax-Span-2149" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2150" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-184">s_1 = link(s_2)</script>.</p>

<p>到此, 我们已经基本理解了 SAM 的 state, suffix link, transition 的概念. 下面将会讲解如何构建 SAM.</p>

<h2 id="samonlineconstructiontheprinciple">SAM Online Construction: The Principle</h2>

<p>假设我们已经为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2151" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1000.83em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2152"><span class="msubsup" id="MathJax-Span-2153"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2154" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-2155" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-185">T_i</script> 构建了 SAM, 该 SAM  的结构使用两个 variables 追踪:</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2156" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.782em 1001.87em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2157"><span class="mi" id="MathJax-Span-2158" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2159" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2160" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2161" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2162" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-186">start</script>: 指向 start state.</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2163" style="width: 1.868em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.434em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.43em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2164"><span class="mi" id="MathJax-Span-2165" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2166" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2167" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2168" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-187">last</script>: 指向"最后一个" state, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-188-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2169" style="width: 10.723em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.379em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.34em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2170"><span class="msubsup" id="MathJax-Span-2171"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2172" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-2173" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2174" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-2175" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-2176" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2177" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2178" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2179" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2180" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2181" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2182" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2183" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-2184" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2185" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2186" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2187" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2188" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2189" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2190" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>i</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-188">T_i \in substrings(last)</script>.</li>
</ul>

<p>为了简化 construction, 在本小节中, SAM  中的每个 State <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-189-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2191" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2192"><span class="mi" id="MathJax-Span-2193" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-189">u</script> 仅维护以下信息:</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2194" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2195"><span class="mi" id="MathJax-Span-2196" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2197" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2198" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2199" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2200" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2201" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2202" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2203" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2204" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-190">maxlen(u)</script></li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2205" style="width: 3.388em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.65em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.61em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2206"><span class="mi" id="MathJax-Span-2207" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2208" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2209" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2210" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2211" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2212" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2213" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-191">link(u)</script></li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2214" style="width: 5.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.299em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.26em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2215"><span class="mi" id="MathJax-Span-2216" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2217" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2218" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2219" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2220" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2221" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2222" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2223" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2224" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">Σ</span><span class="mo" id="MathJax-Span-2225" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-192">trans(u, \Sigma)</script>, 也就是以 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-193-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2226" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2227"><span class="mi" id="MathJax-Span-2228" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-193">u</script> 为起点的 state transitions</li>
</ul>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2229" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.782em 1001.87em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2230"><span class="mi" id="MathJax-Span-2231" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2232" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2233" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2234" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2235" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-194">start</script> 作为一个特殊的 state, 有:</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-195-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2236" style="width: 7.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.82em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2237"><span class="mi" id="MathJax-Span-2238" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2239" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2240" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2241" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2242" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2243" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2244" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2245" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2246" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2247" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-2248" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-195">maxlen(u) = 0</script></li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-196-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2249" style="width: 7.077em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.514em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.51em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2250"><span class="mi" id="MathJax-Span-2251" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2252" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2253" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2254" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2255" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2256" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2257" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2258" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2259" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">n</span><span class="mi" id="MathJax-Span-2260" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2261" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2262" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mi>u</mi><mi>l</mi><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-196">link(u) = null</script></li>
</ul>

<p>以下是一个简单的图例:</p>

<p><img src="./SAM_files/start-last.png" alt="start-last.png"></p>

<p>其中, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-197-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2263" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.782em 1001.87em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2264"><span class="mi" id="MathJax-Span-2265" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2266" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2267" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2268" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2269" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-197">start</script> 是 red state, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2270" style="width: 1.868em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.434em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.43em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2271"><span class="mi" id="MathJax-Span-2272" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2273" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2274" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2275" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-198">last</script> 是 green state.</p>

<p>SAM <a href="https://en.wikipedia.org/wiki/Online_algorithm">online</a> construction 的核心问题是: <strong>如何将 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-199-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2276" style="width: 4.223em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.275em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.682em 1003.19em 2.801em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-2277"><span class="mi" id="MathJax-Span-2278" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.088em;"></span></span><span class="mo" id="MathJax-Span-2279" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2280" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2281" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">+</span><span class="mn" id="MathJax-Span-2282" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">1</span><span class="mo" id="MathJax-Span-2283" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-199">T[i + 1]</script> 插入到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-200-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2284" style="width: 1.079em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.466em 1000.82em 2.543em -999.998em); top: -2.237em; left: 0em;"><span class="mrow" id="MathJax-Span-2285"><span class="msubsup" id="MathJax-Span-2286"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px;"><span style="position: absolute; clip: rect(3.232em 1000.65em 4.137em -999.998em); top: -4.003em; left: 0em;"><span class="mi" id="MathJax-Span-2287" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.088em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.562em;"><span class="mi" id="MathJax-Span-2288" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.242em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-200">T_i</script> 对应的 SAM 里, 插入 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2289" style="width: 0.562em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.433em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.94em 1000.43em 2.629em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-2290"><span class="mi" id="MathJax-Span-2291" style="font-family: STIXGeneral-Italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-201">c</script> 会导致 SAM 的结构发生什么变化?</strong></p>

<p>如果加入 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-202-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2292" style="width: 4.256em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.301em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.21em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2293"><span class="mi" id="MathJax-Span-2294" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2295" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2296" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2297" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2298" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2299" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-202">T[i + 1]</script>, 意味着更新后的 SAM 里必定有一个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2300" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2301"><span class="mi" id="MathJax-Span-2302" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-203">u</script>, 满足 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2303" style="width: 9.421em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.337em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.29em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2304"><span class="mi" id="MathJax-Span-2305" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2306" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2307" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2308" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-2309" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-2310" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2311" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2312" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-2313" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-2314" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2315" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2316" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2317" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>+</mo><mn>1</mn><mo>∈</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-204">i + 1 \in endpos(u)</script>, 而更新前的 SAM 必然不存在这样的 state. 所以, 我们需要创建一个新的 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2318" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.39em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2319"><span class="mi" id="MathJax-Span-2320" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2321" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2322" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-205">cur</script> 使</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-206-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2323" style="width: 10.506em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.205em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.16em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2324"><span class="mi" id="MathJax-Span-2325" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2326" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2327" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2328" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-2329" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-2330" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2331" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2332" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-2333" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-2334" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2335" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2336" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2337" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2338" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-2339" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>+</mo><mn>1</mn><mo>∈</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-206">i + 1 \in endpos(cur)</script></li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-207-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2340" style="width: 11.721em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.16em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1009.12em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2341"><span class="msubsup" id="MathJax-Span-2342"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2343" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="texatom" id="MathJax-Span-2344"><span class="mrow" id="MathJax-Span-2345"><span class="mi" id="MathJax-Span-2346" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2347" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-2348" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2349" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-2350" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-2351" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2352" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2353" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2354" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2355" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2356" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2357" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2358" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-2359" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2360" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2361" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2362" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2363" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-2364" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-207">T_{i + 1} \in substrings(cur)</script></li>
</ul>

<p>把 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-208-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2365" style="width: 4.256em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.301em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.21em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2366"><span class="mi" id="MathJax-Span-2367" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2368" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2369" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2370" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2371" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2372" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-208">T[i + 1]</script> 加入到 SAM, 是期望新的 SAM 可以识别 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-209-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2373" style="width: 2.129em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1001.65em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2374"><span class="msubsup" id="MathJax-Span-2375"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2376" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="texatom" id="MathJax-Span-2377"><span class="mrow" id="MathJax-Span-2378"><span class="mi" id="MathJax-Span-2379" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2380" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-2381" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-209">T_{i + 1}</script> 的 suffix 集合. 这个集合, 恰好是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-210-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2382" style="width: 12.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.768em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1009.68em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2383"><span class="mo" id="MathJax-Span-2384" style="font-family: STIXGeneral-Regular;">{</span><span class="msubsup" id="MathJax-Span-2385"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2386" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-2387" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2388" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mi" id="MathJax-Span-2389" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2390" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2391" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2392" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2393" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2394" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2395" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∣</span><span class="msubsup" id="MathJax-Span-2396" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2397" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-2398" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2399" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="msubsup" id="MathJax-Span-2400" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2401" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-2402" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2403" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo>⊐</mo><msub><mi>T</mi><mi>i</mi></msub><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-210">\{ s_i + T[i + 1] \mid s_i \sqsupset T_i \}</script>, 也就是说, 这是将 symbol <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-211-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2404" style="width: 4.256em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.301em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.21em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2405"><span class="mi" id="MathJax-Span-2406" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2407" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2408" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2409" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2410" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2411" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-211">T[i + 1]</script> 拼接到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-212-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2412" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1000.83em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2413"><span class="msubsup" id="MathJax-Span-2414"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2415" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-2416" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-212">T_i</script> 的所有 suffix 的末尾之后得到的新集合 (当然, 还需要加入一个 empty string, 不过这个是细节性问题).</p>

<p>显然的, 根据 suffix link 的性质, 要得到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-213-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2417" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1000.83em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2418"><span class="msubsup" id="MathJax-Span-2419"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2420" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-2421" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-213">T_i</script> 的 suffix 集合, 只需要访问 suffix-link path from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2422" style="width: 1.868em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.434em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.43em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2423"><span class="mi" id="MathJax-Span-2424" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2425" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2426" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2427" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-214">last</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-215-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2428" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.782em 1001.87em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2429"><span class="mi" id="MathJax-Span-2430" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2431" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2432" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2433" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2434" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-215">start</script> 上的每一个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-216-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2435" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2436"><span class="mi" id="MathJax-Span-2437" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-216">u</script>, 将所有的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-217-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2438" style="width: 6.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.95em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.91em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2439"><span class="mi" id="MathJax-Span-2440" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2441" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2442" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2443" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2444" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2445" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2446" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2447" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2448" style="font-family: STIXGeneral-Italic;">g</span><span class="mo" id="MathJax-Span-2449" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2450" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2451" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-217">substring(u)</script> 合并即可. 由于这些 states 已经代表了 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-218-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2452" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1000.83em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2453"><span class="msubsup" id="MathJax-Span-2454"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2455" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-2456" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-218">T_i</script> 的 suffix 集合, 只需要建立从这些 states 到 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-219-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2457" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.39em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2458"><span class="mi" id="MathJax-Span-2459" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2460" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2461" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-219">cur</script> 的 transition, 就可以使 SAM 能识别 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-220-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2462" style="width: 2.129em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1001.65em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2463"><span class="msubsup" id="MathJax-Span-2464"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2465" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="texatom" id="MathJax-Span-2466"><span class="mrow" id="MathJax-Span-2467"><span class="mi" id="MathJax-Span-2468" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2469" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-2470" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-220">T_{i + 1}</script> 的 suffix 集合.</p>

<p>设 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-221-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2471" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2472"><span class="mi" id="MathJax-Span-2473" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-221">p</script> 为 suffix-link path from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-222-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2474" style="width: 1.868em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.434em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.43em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2475"><span class="mi" id="MathJax-Span-2476" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2477" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2478" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2479" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-222">last</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-223-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2480" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.782em 1001.87em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2481"><span class="mi" id="MathJax-Span-2482" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2483" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2484" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2485" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2486" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-223">start</script> 上当前正在处理的 state, 我们希望可以建立 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-224-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2487" style="width: 12.415em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.681em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1009.68em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2488"><span class="mi" id="MathJax-Span-2489" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2490" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2491" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2492" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2493" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2494" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2495" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2496" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2497" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2498" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2499" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2500" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2501" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2502" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2503" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2504" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2505" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mi" id="MathJax-Span-2506" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2507" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-224">trans(p, T[i + 1]) = cur</script>, 使得 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-225-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mo&gt;&amp;#x2286;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2508" style="width: 27.867em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.747em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1021.7em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2509"><span class="mo" id="MathJax-Span-2510" style="font-family: STIXGeneral-Regular;">{</span><span class="msubsup" id="MathJax-Span-2511"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2512" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-2513" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2514" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mi" id="MathJax-Span-2515" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2516" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2517" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2518" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2519" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2520" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2521" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∣</span><span class="msubsup" id="MathJax-Span-2522" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2523" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-2524" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2525" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-2526" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-2527" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2528" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2529" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2530" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2531" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2532" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2533" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2534" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-2535" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2536" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2537" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2538" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2539" style="font-family: STIXGeneral-Regular;">}</span><span class="mo" id="MathJax-Span-2540" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊆</span><span class="mi" id="MathJax-Span-2541" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-2542" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2543" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2544" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2545" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2546" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2547" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2548" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2549" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-2550" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2551" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2552" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2553" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2554" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-2555" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">}</mo><mo>⊆</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-225">\{ s_i + T[i + 1] \mid s_i \in substrings(p) \} \subseteq substrings(cur)</script>. 那么问题来了, <strong>如果已经存在 state transition <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-226-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2556" style="width: 11.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.788em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.682em 1008.79em 2.845em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-2557"><span class="mi" id="MathJax-Span-2558" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2559" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-2560" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2561" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2562" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2563" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2564" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2565" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2566" style="font-family: STIXGeneral-Italic; padding-left: 0.174em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.088em;"></span></span><span class="mo" id="MathJax-Span-2567" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2568" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2569" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">+</span><span class="mn" id="MathJax-Span-2570" style="font-family: STIXGeneral-Regular; padding-left: 0.261em;">1</span><span class="mo" id="MathJax-Span-2571" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2572" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2573" style="font-family: STIXGeneral-Regular; padding-left: 0.304em;">=</span><span class="mi" id="MathJax-Span-2574" style="font-family: STIXGeneral-Italic; padding-left: 0.304em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-226">trans(p, T[i + 1]) = q</script>, 其中 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-227-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2575" style="width: 0.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.94em 1000.52em 2.845em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-2576"><span class="mi" id="MathJax-Span-2577" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-227">q</script> 是 SAM 里某个已经存在的 state, 我们该怎么处理?</strong></p>

<p>首先, 如果出现了 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-228-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2578" style="width: 11.243em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.77em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.77em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2579"><span class="mi" id="MathJax-Span-2580" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2581" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2582" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2583" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2584" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2585" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2586" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2587" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2588" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2589" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2590" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2591" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2592" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2593" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2594" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2595" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2596" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-228">trans(p, T[i + 1]) = q</script> 的情况, 意味着存在某个 suffix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-229-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2597" style="width: 3.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.563em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1002.56em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2598"><span class="mi" id="MathJax-Span-2599" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2600" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="msubsup" id="MathJax-Span-2601" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2602" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-2603" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>⊐</mo><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-229">x \sqsupset T_i</script> (等价的, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-230-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2604" style="width: 9.073em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.077em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.03em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2605"><span class="mi" id="MathJax-Span-2606" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2607" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-2608" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-2609" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2610" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2611" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2612" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2613" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2614" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2615" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2616" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-2617" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2618" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2619" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2620" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-230">x \in substrings(p)</script>), 使 string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-231-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2621" style="width: 7.164em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.601em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.56em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2622"><span class="mo" id="MathJax-Span-2623" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2624" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2625" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mi" id="MathJax-Span-2626" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2627" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2628" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2629" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2630" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2631" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2632" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-231">(x + T[i + 1])</script></p>

<ul>
<li>是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-232-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2633" style="width: 2.129em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1001.65em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2634"><span class="msubsup" id="MathJax-Span-2635"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2636" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="texatom" id="MathJax-Span-2637"><span class="mrow" id="MathJax-Span-2638"><span class="mi" id="MathJax-Span-2639" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2640" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-2641" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-232">T_{i + 1}</script> 的 suffix (显然).</li>
<li>同时是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-233-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2642" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1000.83em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2643"><span class="msubsup" id="MathJax-Span-2644"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2645" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-2646" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-233">T_i</script> 的某个 substring. 等价的, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-234-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2647" style="width: 15.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.242em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1012.2em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2648"><span class="mo" id="MathJax-Span-2649" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2650" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2651" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mi" id="MathJax-Span-2652" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2653" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2654" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2655" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2656" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2657" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2658" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2659" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-2660" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-2661" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2662" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-2663" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2664" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2665" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2666" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2667" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2668" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-2669" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2670" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2671" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-2672" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>∈</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-234">(x + T[i + 1]) \in substrings(q)</script>. </li>
</ul>

<p>在识别到这个 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-235-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2673" style="width: 11.243em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.77em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.77em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2674"><span class="mi" id="MathJax-Span-2675" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2676" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2677" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2678" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2679" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2680" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2681" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2682" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2683" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2684" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2685" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2686" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2687" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2688" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2689" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2690" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2691" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-235">trans(p, T[i + 1]) = q</script> 之后, 我们可以知道, 原先的 SAM 已经可以识别了 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-236-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2692" style="width: 2.129em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1001.65em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2693"><span class="msubsup" id="MathJax-Span-2694"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2695" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="texatom" id="MathJax-Span-2696"><span class="mrow" id="MathJax-Span-2697"><span class="mi" id="MathJax-Span-2698" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2699" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-2700" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-236">T_{i + 1}</script> 的 suffix 集合的<strong>子集</strong>, 由此, 可以使用 suffix link 将 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-237-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2701" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.39em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2702"><span class="mi" id="MathJax-Span-2703" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2704" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2705" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-237">cur</script> 指向 <strong>某个</strong> state, 这样更新后的 SAM  即可识别 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-238-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2706" style="width: 2.129em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1001.65em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2707"><span class="msubsup" id="MathJax-Span-2708"><span style="display: inline-block; position: relative; width: 1.651em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2709" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="texatom" id="MathJax-Span-2710"><span class="mrow" id="MathJax-Span-2711"><span class="mi" id="MathJax-Span-2712" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2713" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-2714" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-238">T_{i + 1}</script> 的 suffix 集合.</p>

<p>设 <strong>某个</strong> state 为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-239-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2715" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.35em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2716"><span class="mi" id="MathJax-Span-2717" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-2718" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2719" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>r</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-239">pre</script>, 在识别到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-240-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2720" style="width: 11.243em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.77em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.77em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2721"><span class="mi" id="MathJax-Span-2722" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2723" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2724" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2725" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2726" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2727" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2728" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2729" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2730" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2731" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2732" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2733" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2734" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2735" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2736" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2737" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2738" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-240">trans(p, T[i + 1]) = q</script> 的情况下, 需要有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-241-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2739" style="width: 7.945em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.209em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.16em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2740"><span class="mi" id="MathJax-Span-2741" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2742" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2743" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2744" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2745" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2746" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2747" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2748" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-2749" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2750" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2751" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">p</span><span class="mi" id="MathJax-Span-2752" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2753" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mi>r</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-241">link(cur) = pre</script>, 那么, <strong>state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-242-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2754" style="width: 1.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.38em; height: 0px; font-size: 129%;"><span style="position: absolute; clip: rect(1.94em 1001.34em 2.845em -999.998em); top: -2.496em; left: 0em;"><span class="mrow" id="MathJax-Span-2755"><span class="mi" id="MathJax-Span-2756" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-2757" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mi" id="MathJax-Span-2758" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>r</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-242">pre</script> 需要满足什么样的性质?</strong></p>

<p>显然的, 在处理 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-243-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2759" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2760"><span class="mi" id="MathJax-Span-2761" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-243">p</script> 的时候, 已经有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-244-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2762" style="width: 15.106em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.808em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.76em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2763"><span class="mi" id="MathJax-Span-2764" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2765" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2766" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2767" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2768" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2769" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2770" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2771" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2772" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2773" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-2774" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2775" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2776" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-2777" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2778" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2779" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2780" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2781" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2782" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2783" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2784" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2785" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2786" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-244">minlen(cur) = maxlen(p) + 2</script>. 设 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-245-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2787" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.348em 1000.83em 2.606em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-2788"><span class="msup" id="MathJax-Span-2789"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2790" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-2791" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>p</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-245">p'</script> 满足 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-246-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2792" style="width: 6.122em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.776em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1004.73em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2793"><span class="mi" id="MathJax-Span-2794" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2795" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2796" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2797" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2798" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2799" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2800" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-2801"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2802" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-2803" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2804" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>=</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-246">p = link(p')</script>, 根据 suffix link 的定义, 有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-247-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2805" style="width: 14.455em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.287em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1011.24em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2806"><span class="mi" id="MathJax-Span-2807" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2808" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2809" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2810" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2811" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2812" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2813" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2814" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2815" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2816" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2817" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2818" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2819" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-2820" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2821" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2822" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2823" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2824" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2825" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-2826"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2827" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-2828" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2829" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-247">maxlen(p) + 1 = minlen(p')</script>. 由于在处理 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-248-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2830" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2831"><span class="mi" id="MathJax-Span-2832" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-248">p</script> 的时候, 已经存在 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-249-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2833" style="width: 12.806em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.985em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1009.99em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2834"><span class="mi" id="MathJax-Span-2835" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2836" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2837" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2838" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2839" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2840" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-2841"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2842" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-2843" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2844" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2845" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-2846" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2847" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2848" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2849" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2850" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2851" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2852" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2853" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mi" id="MathJax-Span-2854" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2855" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>′</mo></msup><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-249">trans(p', T[i + 1]) = cur</script>, 即有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-250-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2856" style="width: 15.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.981em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1011.89em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2857"><span class="mi" id="MathJax-Span-2858" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2859" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2860" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2861" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2862" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2863" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2864" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2865" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2866" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2867" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-2868" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2869" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2870" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-2871" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2872" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2873" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2874" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2875" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2876" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-2877"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2878" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-2879" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2880" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2881" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2882" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-250">minlen(cur) = minlen(p') + 1</script>. 所以, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-251-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2883" style="width: 24.395em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.056em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1019.01em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2884"><span class="mi" id="MathJax-Span-2885" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2886" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2887" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2888" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2889" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2890" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2891" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2892" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2893" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2894" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-2895" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2896" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2897" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-2898" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2899" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2900" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2902" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2903" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2908" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2910" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2911" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-2912" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2913" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2914" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2915" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2916" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2917" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2918" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2919" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2920" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2921" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-251">minlen(cur) = minlen(p') + 1 = maxlen(p) + 2</script>, 得证.</p>

<p>因为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-252-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2922" style="width: 7.945em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.209em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.16em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2923"><span class="mi" id="MathJax-Span-2924" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2925" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2926" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2927" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2928" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2929" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2930" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2931" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-2932" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2933" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2934" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">p</span><span class="mi" id="MathJax-Span-2935" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2936" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mi>r</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-252">link(cur) = pre</script>, 所以必有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-253-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2937" style="width: 16.278em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.719em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1012.68em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2938"><span class="mi" id="MathJax-Span-2939" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2940" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2941" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2942" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2943" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2944" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2945" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2946" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-2947" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2948" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-2949" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2950" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2951" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-2952" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2953" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-2954" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2955" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2956" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2957" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2958" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2959" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2960" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-2961" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-2962" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-2963" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-253">maxlen(pre) + 1 = minlen(cur)</script>, 结合上面的结论, 可以推导出 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-254-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2964" style="width: 15.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.981em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.89em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2965"><span class="mi" id="MathJax-Span-2966" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2967" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2968" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2969" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2970" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2971" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2972" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2973" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-2974" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2975" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-2976" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2977" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-2978" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-2979" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2980" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2981" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2982" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-2983" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2984" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2985" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2986" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2987" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-2988" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-254">maxlen(pre) = maxlen(p) + 1</script>. 这意味着:</p>

<ul>
<li>存在 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-255-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2989" style="width: 12.415em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.681em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1009.64em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-2990"><span class="mi" id="MathJax-Span-2991" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2992" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-2993" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2994" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2995" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2996" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2997" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-2998" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2999" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3000" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3001" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3002" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3003" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3004" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3005" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3006" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3007" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">p</span><span class="mi" id="MathJax-Span-3008" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3009" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mi>r</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-255">trans(p, T[i + 1]) = pre</script></li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-256-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3010" style="width: 18.969em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.803em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1014.72em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3011"><span class="mi" id="MathJax-Span-3012" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3013" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-3014" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3015" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-3016" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3017" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3018" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3019" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3020" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-3021" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3022" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-3023" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3024" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3025" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3026" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-3027" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3028" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-3029" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3030" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3031" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3032" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3033" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3034" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3035" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mi" id="MathJax-Span-3036" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3037" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3038" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3039" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3040" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3041" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-256">longest(pre) = longest(p) + T[i + 1]</script></li>
</ul>

<p>And that's it! 我们需要检测 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-257-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3042" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3043"><span class="mi" id="MathJax-Span-3044" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-257">q</script> 是否满足作为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-258-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3045" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.35em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3046"><span class="mi" id="MathJax-Span-3047" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-3048" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3049" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>r</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-258">pre</script> 的条件:</p>

<ol>
<li>如果 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-259-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3050" style="width: 14.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.113em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.07em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3051"><span class="mi" id="MathJax-Span-3052" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-3053" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3054" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3055" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3056" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3057" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3058" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3059" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3060" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3061" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3062" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3063" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3064" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-3065" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3066" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3067" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3068" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3069" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3070" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3071" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3072" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-259">maxlen(p) + 1 = maxlen(q)</script>, 那么 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-260-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3073" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3074"><span class="mi" id="MathJax-Span-3075" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-260">q</script> 就是我们要找的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-261-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3076" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.35em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3077"><span class="mi" id="MathJax-Span-3078" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-3079" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3080" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>r</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-261">pre</script>, 直接设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-262-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3081" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.34em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3082"><span class="mi" id="MathJax-Span-3083" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3084" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3085" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3086" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3087" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3088" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-3089" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3090" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-3091" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3092" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3093" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-262">link(cur) = q</script>.  </li>
<li>如果 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-263-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x003C;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3094" style="width: 14.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.113em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.07em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3095"><span class="mi" id="MathJax-Span-3096" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-3097" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3098" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3099" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3100" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3101" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3102" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3103" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3104" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3105" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3106" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3107" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">&lt;</span><span class="mi" id="MathJax-Span-3108" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-3109" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3110" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3111" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3112" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3113" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3114" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3115" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3116" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>&lt;</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-263">maxlen(p) + 1 \lt maxlen(q)</script>, 这意味着 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-264-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2282;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3117" style="width: 15.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.025em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.98em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3118"><span class="mi" id="MathJax-Span-3119" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3120" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3121" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-3122" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3123" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3124" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3125" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3126" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3127" style="font-family: STIXGeneral-Italic;">g</span><span class="mo" id="MathJax-Span-3128" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3129" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-3130" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3131" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-3132" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3133" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊂</span><span class="mi" id="MathJax-Span-3134" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-3135" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3136" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-3137" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3138" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3139" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3140" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3141" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3142" style="font-family: STIXGeneral-Italic;">g</span><span class="mo" id="MathJax-Span-3143" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3144" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3145" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><mi>e</mi><mo stretchy="false">)</mo><mo>⊂</mo><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-264">substring(pre) \subset substring(q)</script>. 这个时候, 需要将满足 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-265-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3146" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.35em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3147"><span class="mi" id="MathJax-Span-3148" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-3149" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3150" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>r</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-265">pre</script> 条件的部分从 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-266-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3151" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3152"><span class="mi" id="MathJax-Span-3153" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-266">q</script> 里面剥离出去!  </li>
<li>显然的, 不可能出现 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-267-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x003E;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3154" style="width: 14.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.113em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.07em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3155"><span class="mi" id="MathJax-Span-3156" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-3157" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3158" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3159" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3160" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3161" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3162" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3163" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3164" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3165" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3166" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3167" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">&gt;</span><span class="mi" id="MathJax-Span-3168" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-3169" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3170" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3171" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3172" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3173" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3174" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3175" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3176" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>&gt;</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-267">maxlen(p) + 1 \gt maxlen(q)</script> 的情况.</li>
</ol>

<p>对于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-268-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x003C;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3177" style="width: 14.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.113em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.07em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3178"><span class="mi" id="MathJax-Span-3179" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-3180" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3181" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3182" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3183" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3184" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3185" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3186" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3187" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3188" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3189" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3190" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">&lt;</span><span class="mi" id="MathJax-Span-3191" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-3192" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3193" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3194" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3195" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3196" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3197" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3198" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3199" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>&lt;</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-268">maxlen(p) + 1 \lt maxlen(q)</script> 的情况, 利用在 state transition 小节得到的结论, 我们可以知道, 对于 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-269-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3200" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3201"><span class="mi" id="MathJax-Span-3202" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-269">p</script> 所在的 suffix-link path, 必然有 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-270-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3203" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.348em 1000.83em 2.606em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-3204"><span class="msup" id="MathJax-Span-3205"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3206" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3207" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>p</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-270">p'</script> 满足 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-271-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3208" style="width: 6.122em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.776em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1004.73em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3209"><span class="mi" id="MathJax-Span-3210" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3211" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3212" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3213" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3214" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3215" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3216" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-3217"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3218" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3219" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-3220" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>=</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-271">p = link(p')</script> 且存在 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-272-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3221" style="width: 11.678em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.117em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1009.12em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3222"><span class="mi" id="MathJax-Span-3223" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3224" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3225" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3226" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3227" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3228" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-3229"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3230" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3231" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-3232" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3233" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3234" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3235" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3236" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3237" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3238" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3239" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3240" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3241" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>′</mo></msup><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-272">trans(p', T[i + 1]) = q</script>. 由此, 可以将以 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-273-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3242" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3243"><span class="mi" id="MathJax-Span-3244" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-273">q</script> 为终点的 transition 分为两个部分:</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-274-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3245" style="width: 7.25em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.645em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1005.6em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3246"><span class="mi" id="MathJax-Span-3247" style="font-family: STIXGeneral-Italic;">P</span><span class="mi" id="MathJax-Span-3248" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3249" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3250" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3251" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3252" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3253" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3254" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mi" id="MathJax-Span-3255" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3256" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3257" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3258" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-274">ParentsTrans</script>: 包含满足条件的 state transitions <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-275-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3259" style="width: 11.243em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.77em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.77em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3260"><span class="mi" id="MathJax-Span-3261" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3262" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3263" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3264" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3265" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3266" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3267" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3268" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3269" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3270" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3271" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3272" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3273" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3274" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3275" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3276" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3277" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-275">trans(u, T[i + 1]) = q</script>, 对于其中的任意 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-276-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3278" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3279"><span class="mi" id="MathJax-Span-3280" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-276">u</script>, 满足存在 suffix-link path from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-277-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3281" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3282"><span class="mi" id="MathJax-Span-3283" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-277">u</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-278-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3284" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.348em 1000.83em 2.606em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-3285"><span class="msup" id="MathJax-Span-3286"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3287" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3288" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>p</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-278">p'</script>, 包括 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-279-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3289" style="width: 3.344em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.606em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1002.61em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3290"><span class="mi" id="MathJax-Span-3291" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3292" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="msup" id="MathJax-Span-3293" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3294" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3295" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>=</mo><msup><mi>p</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-279">u = p'</script> 的情况.</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-280-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3296" style="width: 7.901em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.165em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.12em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3297"><span class="mi" id="MathJax-Span-3298" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3299" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-3300" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3301" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3302" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3303" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3304" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3305" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3306" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mi" id="MathJax-Span-3307" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3308" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3309" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3310" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>h</mi><mi>i</mi><mi>l</mi><mi>d</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-280">ChildrenTrans</script>: 包含满足条件的 state transitions <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-281-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3311" style="width: 11.243em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.77em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.77em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3312"><span class="mi" id="MathJax-Span-3313" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3314" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3315" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3316" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3317" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3318" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3319" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3320" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3321" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3322" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3323" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3324" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3325" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3326" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3327" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3328" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3329" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-281">trans(u, T[i + 1]) = q</script>, 对于其中的任意 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-282-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3330" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3331"><span class="mi" id="MathJax-Span-3332" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-282">u</script>, 满足存在 suffix-link path from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-283-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3333" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3334"><span class="mi" id="MathJax-Span-3335" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-283">p</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-284-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3336" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3337"><span class="mi" id="MathJax-Span-3338" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-284">u</script>, 包括 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-285-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3339" style="width: 2.954em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.303em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1002.26em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3340"><span class="mi" id="MathJax-Span-3341" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3342" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3343" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>=</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-285">u = p</script> 的情况.</li>
</ul>

<p>以下为对应图例:</p>

<p><img src="./SAM_files/sq.png" alt="sq.png"></p>

<p>其中, state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-286-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2033;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3344" style="width: 1.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.348em 1001em 2.606em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-3345"><span class="msup" id="MathJax-Span-3346"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3347" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3348" style="font-size: 70.7%; font-family: STIXVariants;">″</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>p</mi><mo>″</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-286">p''</script> 是 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-287-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3349" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3350"><span class="mi" id="MathJax-Span-3351" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-287">p</script> 的 child (through suffix link), 是最后一个满足 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-288-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3352" style="width: 11.243em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.77em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.77em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3353"><span class="mi" id="MathJax-Span-3354" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3355" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3356" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3357" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3358" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3359" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3360" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3361" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3362" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3363" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3364" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3365" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3366" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3367" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3368" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3369" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3370" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-288">trans(u, T[i + 1]) = q</script> 条件的 state, 也就是说, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-289-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2033;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3371" style="width: 1.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.348em 1001em 2.606em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-3372"><span class="msup" id="MathJax-Span-3373"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3374" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3375" style="font-size: 70.7%; font-family: STIXVariants;">″</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>p</mi><mo>″</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-289">p''</script> 满足以下条件中的一个:</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-290-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2033;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3376" style="width: 7.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.035em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1006.03em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3377"><span class="mi" id="MathJax-Span-3378" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3379" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3380" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3381" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3382" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-3383"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3384" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3385" style="font-size: 70.7%; font-family: STIXVariants;">″</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-3386" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3387" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3388" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">n</span><span class="mi" id="MathJax-Span-3389" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3390" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3391" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>″</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mi>u</mi><mi>l</mi><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-290">link(p'') = null</script>, 即 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-291-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2033;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3392" style="width: 5.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1004.17em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3393"><span class="msup" id="MathJax-Span-3394"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3395" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3396" style="font-size: 70.7%; font-family: STIXVariants;">″</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-3397" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3398" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-3399" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3400" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3401" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3402" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>p</mi><mo>″</mo></msup><mo>=</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-291">p'' = start</script></li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-292-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2033;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3403" style="width: 12.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.638em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1009.59em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3404"><span class="mi" id="MathJax-Span-3405" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3406" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3407" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3408" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3409" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3410" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3411" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3412" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3413" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3414" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3415" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-3416"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3417" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3418" style="font-size: 70.7%; font-family: STIXVariants;">″</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-3419" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3420" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3421" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3422" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3423" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3424" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3425" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3426" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3427" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>″</mo></msup><mo stretchy="false">)</mo><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-292">trans(link(p''), T[i + 1])</script> 不存在</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-293-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2033;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3428" style="width: 12.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.638em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1009.59em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3429"><span class="mi" id="MathJax-Span-3430" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3431" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3432" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3433" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3434" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3435" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3436" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3437" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3438" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3439" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3440" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-3441"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3442" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3443" style="font-size: 70.7%; font-family: STIXVariants;">″</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-3444" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3445" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3446" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3447" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3448" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3449" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3450" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3451" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3452" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>″</mo></msup><mo stretchy="false">)</mo><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-293">trans(link(p''), T[i + 1])</script> 存在, 但 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-294-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2033;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3453" style="width: 14.672em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.461em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1011.46em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3454"><span class="mi" id="MathJax-Span-3455" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3456" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3457" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3458" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3459" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3460" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3461" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3462" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3463" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3464" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3465" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-3466"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3467" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3468" style="font-size: 70.7%; font-family: STIXVariants;">″</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-3469" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3470" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3471" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3472" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3473" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3474" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3475" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3476" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3477" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3478" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">≠</span><span class="mi" id="MathJax-Span-3479" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><msup><mi>p</mi><mo>″</mo></msup><mo stretchy="false">)</mo><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>≠</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-294">trans(link(p''), T[i + 1]) \neq q</script></li>
</ul>

<p>由于 state transition 决定了 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-295-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3480" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3481"><span class="mi" id="MathJax-Span-3482" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3483" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3484" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-3485" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3486" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3487" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3488" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3489" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3490" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-3491" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3492" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3493" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3494" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-295">substrings(q)</script>, 为了将属于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-296-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3495" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.35em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3496"><span class="mi" id="MathJax-Span-3497" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-3498" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3499" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>r</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-296">pre</script> 的部分从 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-297-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3500" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3501"><span class="mi" id="MathJax-Span-3502" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-297">q</script> 中分离出来, 可以新建一个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-298-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3503" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3504"><span class="mi" id="MathJax-Span-3505" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3506" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-298">sq</script>, 将 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-299-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3507" style="width: 7.901em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.165em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.12em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3508"><span class="mi" id="MathJax-Span-3509" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3510" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-3511" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3512" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3513" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3514" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3515" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3516" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3517" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mi" id="MathJax-Span-3518" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3519" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3520" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3521" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>h</mi><mi>i</mi><mi>l</mi><mi>d</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-299">ChildrenTrans</script> 中的 transitions 全部转向 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-300-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3522" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3523"><span class="mi" id="MathJax-Span-3524" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3525" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-300">sq</script>. 如下图所示:</p>

<p><img src="./SAM_files/sq1.png" alt="sq1.png"></p>

<p>处理完以 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-301-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3526" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3527"><span class="mi" id="MathJax-Span-3528" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3529" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-301">sq</script> 为<strong>终点</strong>的 transitions 之后, 还需要考虑以 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-302-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3530" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3531"><span class="mi" id="MathJax-Span-3532" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3533" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-302">sq</script> 为<strong>起点</strong>的 transitions. 显然的, 对于所有的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-303-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3534" style="width: 8.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.252em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1006.25em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3535"><span class="mi" id="MathJax-Span-3536" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3537" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3538" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3539" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3540" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3541" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3542" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3543" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3544" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">c</span><span class="mo" id="MathJax-Span-3545" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3546" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="msup" id="MathJax-Span-3547" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3548" style="font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3549" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>q</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>q</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-303">trans(q, c) = q'</script>, 也必须存在有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-304-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3550" style="width: 8.509em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.643em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.565em 1006.64em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3551"><span class="mi" id="MathJax-Span-3552" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3553" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3554" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3555" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3556" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3557" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3558" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3559" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3560" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3561" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">c</span><span class="mo" id="MathJax-Span-3562" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3563" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="msup" id="MathJax-Span-3564" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.48em 4.342em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3565" style="font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -4.338em; left: 0.523em;"><span class="mo" id="MathJax-Span-3566" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>q</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>q</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-304">trans(sq, c) = q'</script>. 所以, 直接把 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-305-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3567" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3568"><span class="mi" id="MathJax-Span-3569" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-305">q</script> 维护的 transitions copy 给 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-306-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3570" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3571"><span class="mi" id="MathJax-Span-3572" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3573" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-306">sq</script> 就可以了.</p>

<p>完成 transition 的调整之后, 还需要调整 suffix links:</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-307-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3574" style="width: 9.03em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.033em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.99em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3575"><span class="mi" id="MathJax-Span-3576" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3577" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3578" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3579" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3580" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3581" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3582" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3583" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3584" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3585" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3586" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3587" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3588" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3589" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3590" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3591" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>s</mi><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-307">link(sq) = link(q)</script>, 原因在于, 原先的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-308-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3592" style="width: 5.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.386em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.34em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3593"><span class="mi" id="MathJax-Span-3594" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3595" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-3596" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-3597" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3598" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3599" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3600" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3601" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3602" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3603" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3604" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>h</mi><mi>o</mi><mi>r</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-308">shortest(q)</script> 现在已经在 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-309-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3605" style="width: 7.337em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.731em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.69em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3606"><span class="mi" id="MathJax-Span-3607" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3608" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3609" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-3610" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3611" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3612" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3613" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3614" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3615" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-3616" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3617" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3618" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3619" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3620" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-309">substrings(sq)</script> 集合里, 所以需要调整 suffix link 以保证 suffix-link 的"连续性".</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-310-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3621" style="width: 6.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.863em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.86em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3622"><span class="mi" id="MathJax-Span-3623" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3624" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3625" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3626" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3627" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3628" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3629" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3630" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3631" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-3632" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-310">link(q) = sq</script>, 原因同上.</li>
</ul>

<p>至此, 我们已经从 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-311-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3633" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3634"><span class="mi" id="MathJax-Span-3635" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-311">q</script> 中分离出满足 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-312-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3636" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.35em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3637"><span class="mi" id="MathJax-Span-3638" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-3639" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3640" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>r</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-312">pre</script> 特性的 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-313-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3641" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3642"><span class="mi" id="MathJax-Span-3643" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3644" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-313">sq</script>! 最后, 设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-314-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3645" style="width: 7.337em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.731em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.73em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3646"><span class="mi" id="MathJax-Span-3647" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3648" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3649" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3650" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3651" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3652" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-3653" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3654" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-3655" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3656" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3657" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-3658" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-314">link(cur) = sq</script>, Done!</p>

<h2 id="samonlineconstructionthepseudocode">SAM Online Construction: The Pseudocode</h2>

<p>利用上一小节的结论, 可以给出将 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-315-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3659" style="width: 2.086em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.608em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1001.52em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3660"><span class="mi" id="MathJax-Span-3661" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3662" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3663" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3664" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-315">T[i]</script> 插入到 SAM 的算法步骤 (注意, 上一小节我们讨论的是将 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-316-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3665" style="width: 4.256em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.301em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.21em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3666"><span class="mi" id="MathJax-Span-3667" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3668" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3669" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3670" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3671" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3672" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-316">T[i + 1]</script> 插入到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-317-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3673" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.478em 1000.83em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-3674"><span class="msubsup" id="MathJax-Span-3675"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.65em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-3676" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.566em;"><span class="mi" id="MathJax-Span-3677" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-317">T_i</script> 的 SAM 里, 所以下面的表述会有细微的区别, 但原理是一样的):</p>

<ol>
<li>新建一个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-318-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3678" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.39em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3679"><span class="mi" id="MathJax-Span-3680" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-3681" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3682" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-318">cur</script>, 使 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-319-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3683" style="width: 16.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.936em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1012.85em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3684"><span class="mi" id="MathJax-Span-3685" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-3686" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3687" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3688" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3689" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3690" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3691" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3692" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-3693" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3694" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-3695" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3696" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3697" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-3698" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3699" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3700" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3701" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3702" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3703" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3704" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3705" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3706" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3707" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3708" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3709" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3710" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-319">maxlen(cur) = maxlen(last) + 1</script>.  </li>
<li>从 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-320-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3711" style="width: 1.868em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.434em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.43em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3712"><span class="mi" id="MathJax-Span-3713" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3714" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3715" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3716" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-320">last</script> 开始, 沿着 suffix-link path from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-321-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3717" style="width: 1.868em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.434em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.43em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3718"><span class="mi" id="MathJax-Span-3719" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3720" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3721" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3722" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-321">last</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-322-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3723" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.782em 1001.87em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3724"><span class="mi" id="MathJax-Span-3725" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3726" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3727" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3728" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3729" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-322">start</script> 访问每个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-323-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3730" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3731"><span class="mi" id="MathJax-Span-3732" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-323">p</script>, 直到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-324-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3733" style="width: 4.299em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.344em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.34em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3734"><span class="mi" id="MathJax-Span-3735" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3736" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3737" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">n</span><span class="mi" id="MathJax-Span-3738" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3739" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3740" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>=</mo><mi>n</mi><mi>u</mi><mi>l</mi><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-324">p = null</script> 或者存在 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-325-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3741" style="width: 6.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.297em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.25em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3742"><span class="mi" id="MathJax-Span-3743" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3744" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3745" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3746" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3747" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3748" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3749" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3750" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3751" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3752" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3753" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3754" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3755" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-325">trans(p, T[i])</script> 的情况. 在循环中, 设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-326-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3756" style="width: 10.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.945em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.95em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3757"><span class="mi" id="MathJax-Span-3758" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3759" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3760" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3761" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3762" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3763" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3764" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3765" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3766" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3767" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3768" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3769" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3770" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3771" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3772" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mi" id="MathJax-Span-3773" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3774" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-326">trans(p, T[i]) = cur</script>.  </li>
<li>判断 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-327-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3775" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3776"><span class="mi" id="MathJax-Span-3777" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-327">p</script> 是否为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-328-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3778" style="width: 1.999em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.57em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3779"><span class="mi" id="MathJax-Span-3780" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3781" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3782" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3783" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mi>u</mi><mi>l</mi><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-328">null</script>. 如果 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-329-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3784" style="width: 4.299em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.344em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.34em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3785"><span class="mi" id="MathJax-Span-3786" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3787" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3788" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">n</span><span class="mi" id="MathJax-Span-3789" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3790" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3791" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>=</mo><mi>n</mi><mi>u</mi><mi>l</mi><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-329">p = null</script>, 则设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-330-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3792" style="width: 8.639em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.73em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.73em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3793"><span class="mi" id="MathJax-Span-3794" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3795" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3796" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3797" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3798" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3799" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-3800" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3801" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-3802" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3803" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3804" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-3805" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3806" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3807" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3808" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-330">link(cur) = start</script>,  结束后续操作. 反之, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-331-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3809" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3810"><span class="mi" id="MathJax-Span-3811" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-331">p</script> 是某个合法的 state, 且有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-332-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3812" style="width: 9.073em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.077em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.08em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3813"><span class="mi" id="MathJax-Span-3814" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3815" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-3816" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3817" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3818" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-3819" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3820" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3821" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3822" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3823" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3824" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3825" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3826" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3827" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3828" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-332">trans(p, T[i]) = q</script>.  </li>
<li>如果 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-333-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3829" style="width: 14.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.113em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.07em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3830"><span class="mi" id="MathJax-Span-3831" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-3832" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3833" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3834" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3835" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3836" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3837" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3838" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3839" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3840" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3841" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3842" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3843" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-3844" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3845" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3846" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3847" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3848" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3849" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3850" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3851" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-333">maxlen(p) + 1 = maxlen(q)</script>, 设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-334-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3852" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.34em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3853"><span class="mi" id="MathJax-Span-3854" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3855" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3856" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3857" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3858" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3859" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-3860" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3861" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-3862" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3863" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3864" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-334">link(cur) = q</script>.  </li>
<li>如果 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-335-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x003C;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3865" style="width: 14.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.113em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.07em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3866"><span class="mi" id="MathJax-Span-3867" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-3868" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3869" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3870" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3871" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3872" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3873" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3874" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-3875" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3876" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-3877" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-3878" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">&lt;</span><span class="mi" id="MathJax-Span-3879" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-3880" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3881" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3882" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3883" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-3884" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3885" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3886" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3887" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>&lt;</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-335">maxlen(p) + 1 \lt maxlen(q)</script>, 从 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-336-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3888" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3889"><span class="mi" id="MathJax-Span-3890" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-336">q</script> 中拆分出 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-337-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3891" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3892"><span class="mi" id="MathJax-Span-3893" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3894" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-337">sq</script>, 设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-338-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3895" style="width: 9.03em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.033em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.99em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3896"><span class="mi" id="MathJax-Span-3897" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3898" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3899" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3900" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3901" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3902" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3903" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3904" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3905" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3906" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3907" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3908" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3909" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3910" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3911" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3912" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>s</mi><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-338">link(sq) = link(q)</script>, 之后设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-339-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3913" style="width: 6.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.863em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.86em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3914"><span class="mi" id="MathJax-Span-3915" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3916" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3917" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3918" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3919" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3920" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-3921" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3922" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3923" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-3924" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-339">link(q) = sq</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-340-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3925" style="width: 7.337em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.731em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.73em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3926"><span class="mi" id="MathJax-Span-3927" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3928" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-3929" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-3930" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3931" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3932" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-3933" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3934" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-3935" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3936" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3937" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-3938" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-340">link(cur) = sq</script>.  </li>
<li>更新 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-341-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3939" style="width: 1.868em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.434em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.43em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3940"><span class="mi" id="MathJax-Span-3941" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3942" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3943" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3944" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-341">last</script>, 使 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-342-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3945" style="width: 5.297em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.125em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.12em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3946"><span class="mi" id="MathJax-Span-3947" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3948" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-3949" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-3950" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3951" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-3952" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">c</span><span class="mi" id="MathJax-Span-3953" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-3954" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo>=</mo><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-342">last = cur</script>.</li>
</ol>

<p>以下是对应的 pseudocode:</p>

<pre><code class=" line-numbers">Procedure Name: AddSymbolToSAM  
Input: start, last, T[i]  
Output: cur

# (1)
create state cur  
maxlen(cur) = maxlen(last) + 1

# (2)
p = last  
while p is not null AND trans(p, T[i]) not exists:  
  trans(p, T[i]) = cur
  p = link(p)

# (3)
if p is null:  
  link(cur) = start
  return cur

q = trans(p, T[i])  
if maxlen(p) + 1 = maxlen(q):  
  # (4)
  link(cur) = q
else:  
  # (5)
  create state sq
  maxlen(sq) = maxlen(p) + 1
  for all trans(q, c) = q':
    trans(sq, c) = q'

  while p is valid AND trans(p, T[i]) = q:
    trans(p, T[i]) = sq
    p = link(p)

  link(sq) = link(q)
  link(q) = sq
  link(cur) = sq

reutrn cur  
</code></pre>

<p>所以, 给定一个 string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-343-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3955" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3956"><span class="mi" id="MathJax-Span-3957" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-343">T</script>, 构建对应 SAM 的 pseudocode 如下所示:</p>

<pre><code class=" line-numbers">Procedure Name: CreateSAM  
Input: T  
Output: start

create state start  
last = start

for i in 1 to length(T):  
  last = AddSymbolToSAM(start, last, T[i])

return start  
</code></pre>

<p>Boom! SAM 的算法虽然理解上比较困难, 但是写起来还是很简单的, 基本上用 30-40 行的 C++ 代码就可以写完. 下面给出构建 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-344-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3958" style="width: 6.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.428em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.34em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3959"><span class="mi" id="MathJax-Span-3960" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3961" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">"</span></span><span class="mi" id="MathJax-Span-3962" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-3963" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-3964" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-3965" style="font-family: STIXGeneral-Italic;">b</span><span class="mi" id="MathJax-Span-3966" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-3967" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">"</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>="</mo><mi>a</mi><mi>b</mi><mi>c</mi><mi>b</mi><mi>c</mi><mo>"</mo></math></span></span><script type="math/tex" id="MathJax-Element-344">T = "abcbc"</script> 的过程, 图片使用 <a href="https://github.com/huntzhan/SAM-PNG">SAM-PNG</a> + <a href="https://en.wikipedia.org/wiki/DOT_(graph_description_language)">DOT</a> 生成, <a href="https://github.com/huntzhan/SAM-PNG">SAM-PNG</a> 是我用 C++ 写的 SAM 实现, 有需要的同学也可以去看一下.</p>

<p>初始化:</p>

<p><img src="./SAM_files/example-empty.png" alt="example-empty.png"></p>

<p>加入 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-345-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3968" style="width: 2.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.825em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.74em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3969"><span class="mi" id="MathJax-Span-3970" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3971" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-3972" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-3973" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-345">T[1]</script>:</p>

<p><img src="./SAM_files/example-a.png" alt="example-a.png"></p>

<p>加入 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-346-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3974" style="width: 2.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.825em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.74em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3975"><span class="mi" id="MathJax-Span-3976" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3977" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-3978" style="font-family: STIXGeneral-Regular;">2</span><span class="mo" id="MathJax-Span-3979" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-346">T[2]</script>:</p>

<p><img src="./SAM_files/example-ab.png" alt="example-ab.png"></p>

<p>加入 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-347-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3980" style="width: 2.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.825em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.74em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3981"><span class="mi" id="MathJax-Span-3982" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3983" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-3984" style="font-family: STIXGeneral-Regular;">3</span><span class="mo" id="MathJax-Span-3985" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-347">T[3]</script>:</p>

<p><img src="./SAM_files/example-abc.png" alt="example-abc.png"></p>

<p>加入 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-348-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3986" style="width: 2.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.825em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.74em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3987"><span class="mi" id="MathJax-Span-3988" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3989" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-3990" style="font-family: STIXGeneral-Regular;">4</span><span class="mo" id="MathJax-Span-3991" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>4</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-348">T[4]</script>:</p>

<p><img src="./SAM_files/abcb[Fp44MnZpw2P9qnKVU8NLu3uHtrCJ].png" alt="abcb[Fp44MnZpw2P9qnKVU8NLu3uHtrCJ].png" title=""></p>

<p>加入 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-349-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3992" style="width: 2.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.825em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.74em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3993"><span class="mi" id="MathJax-Span-3994" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-3995" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-3996" style="font-family: STIXGeneral-Regular;">5</span><span class="mo" id="MathJax-Span-3997" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>5</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-349">T[5]</script>:</p>

<p><img src="./SAM_files/example-abcbc.png" alt="example-abcbc.png"></p>

<h2 id="samthetimespacecomplexity">SAM: The Time/Space Complexity</h2>

<p>问题: 对于 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-350-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3998" style="width: 7.164em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.601em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.56em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-3999"><span class="mi" id="MathJax-Span-4000" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4001" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4002" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4003" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4004" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4005" style="font-family: STIXGeneral-Italic;">g</span><span class="mi" id="MathJax-Span-4006" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4007" style="font-family: STIXGeneral-Italic;">h</span><span class="mo" id="MathJax-Span-4008" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4009" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-4010" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-350">n = length(T)</script>, 求 SAM 的 time/space complexity.</p>

<p>先来考虑 space complexity. 由于 SAM 本质上是 graph, 所以在考虑 space complexity 的时候, 需要考虑 state (node) 与 transition (edge) 的数量.</p>

<p>根据 SAM 的构建过程, 往 SAM 里加入 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-351-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4011" style="width: 2.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.825em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.74em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4012"><span class="mi" id="MathJax-Span-4013" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-4014" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-4015" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-4016" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-351">T[1]</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-352-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4017" style="width: 2.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.825em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.74em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4018"><span class="mi" id="MathJax-Span-4019" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-4020" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-4021" style="font-family: STIXGeneral-Regular;">2</span><span class="mo" id="MathJax-Span-4022" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-352">T[2]</script> 时, 仅会增加 1 state, 对于剩下的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-353-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4023" style="width: 2.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.825em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.74em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4024"><span class="mi" id="MathJax-Span-4025" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-4026" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-4027" style="font-family: STIXGeneral-Regular;">3</span><span class="mo" id="MathJax-Span-4028" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>3</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-353">T[3]</script> 至 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-354-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4029" style="width: 2.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.825em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1001.74em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4030"><span class="mi" id="MathJax-Span-4031" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-4032" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-4033" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4034" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-354">T[n]</script>, 每次处理最多增加 2 states, 所以, state 的上限是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-355-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4035" style="width: 13.804em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.766em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1010.68em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4036"><span class="mn" id="MathJax-Span-4037" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-4038" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-4039" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">2</span><span class="mo" id="MathJax-Span-4040" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-4041" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">2</span><span class="mo" id="MathJax-Span-4042" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4043" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4044" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">−</span><span class="mn" id="MathJax-Span-4045" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">2</span><span class="mo" id="MathJax-Span-4046" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4047" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-4048" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">2</span><span class="mi" id="MathJax-Span-4049" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4050" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">−</span><span class="mn" id="MathJax-Span-4051" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>2</mn><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-355">1 + 2 + 2(n - 2) = 2n - 1</script>, 即 state 的数量是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-356-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4052" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.83em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4053"><span class="mi" id="MathJax-Span-4054" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-4055" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4056" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4057" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-356">O(n)</script>.</p>

<p>为了得出 transition 的数量, 先定义出两类 transition. 给定一个 transition <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-357-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4058" style="width: 7.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.86em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4059"><span class="mi" id="MathJax-Span-4060" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4061" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4062" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4063" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4064" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4065" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4066" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4067" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-4068" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">c</span><span class="mo" id="MathJax-Span-4069" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4070" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4071" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-357">trans(u, c) = v</script>:</p>

<ul>
<li>如果 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-358-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4072" style="width: 14.195em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.07em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.03em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4073"><span class="mi" id="MathJax-Span-4074" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4075" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4076" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4077" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4078" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4079" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4080" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4081" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4082" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4083" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-4084" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-4085" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4086" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-4087" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4088" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4089" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4090" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4091" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4092" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4093" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-4094" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-358">maxlen(u) + 1 = maxlen(v)</script>, 则称之为 continuous transition.</li>
<li>反之, 称之为 discontinuous transition.</li>
</ul>

<p>由于 state 的上限是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-359-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4095" style="width: 3.474em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.693em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.61em 2.737em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4096"><span class="mn" id="MathJax-Span-4097" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-4098" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4099" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">−</span><span class="mn" id="MathJax-Span-4100" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-359">2n - 1</script>, 所以 continues transition 数量的上限是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-360-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4101" style="width: 3.474em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.693em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.65em 2.737em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4102"><span class="mn" id="MathJax-Span-4103" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-4104" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4105" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">−</span><span class="mn" id="MathJax-Span-4106" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>n</mi><mo>−</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-360">2n - 2</script>, 即 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-361-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4107" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.83em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4108"><span class="mi" id="MathJax-Span-4109" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-4110" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4111" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4112" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-361">O(n)</script>.</p>

<p>对于每个 discontinues transition <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-362-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4113" style="width: 7.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.86em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4114"><span class="mi" id="MathJax-Span-4115" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4116" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4117" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4118" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4119" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4120" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4121" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4122" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-4123" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">c</span><span class="mo" id="MathJax-Span-4124" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4125" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4126" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-362">trans(u, c) = v</script>, 设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-363-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4127" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.83em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-4128"><span class="msubsup" id="MathJax-Span-4129"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-4130" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-4131" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>u</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-363">s_u</script> 为从 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-364-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4132" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.782em 1001.87em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4133"><span class="mi" id="MathJax-Span-4134" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4135" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4136" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4137" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4138" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-364">start</script> 到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-365-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4139" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4140"><span class="mi" id="MathJax-Span-4141" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-365">u</script> 的最长 path, 这个 path 中必然只包含 continues transition. 设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-366-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4142" style="width: 1em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.78em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-4143"><span class="msubsup" id="MathJax-Span-4144"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-4145" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-4146" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>v</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-366">s_v</script> 为从 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-367-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4147" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.44em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4148"><span class="mi" id="MathJax-Span-4149" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.725em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-367">v</script> 到 accept state 的, 最长的只包含 continues transition 的路径, 由于每个 state 要么是 accept state, 要么存在以这个 state 为起点的一个或多个 continues transition, 所以 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-368-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4150" style="width: 1em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.78em 2.563em -999.998em); top: -2.255em; left: 0em;"><span class="mrow" id="MathJax-Span-4151"><span class="msubsup" id="MathJax-Span-4152"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-4153" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-4154" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.259em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>v</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-368">s_v</script> 也必然存在. 所以, 对于所有的 discontinues transition <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-369-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4155" style="width: 7.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.86em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4156"><span class="mi" id="MathJax-Span-4157" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4158" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4159" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4160" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4161" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4162" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4163" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4164" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-4165" style="font-family: STIXGeneral-Italic; padding-left: 0.176em;">c</span><span class="mo" id="MathJax-Span-4166" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4167" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4168" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">v</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-369">trans(u, c) = v</script>, 必然有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-370-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2290;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4169" style="width: 9.073em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.077em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.08em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4170"><span class="mo" id="MathJax-Span-4171" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-4172"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-4173" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-4174" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-4175" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mi" id="MathJax-Span-4176" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">c</span><span class="mo" id="MathJax-Span-4177" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="msubsup" id="MathJax-Span-4178" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-4179" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-4180" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-4181" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4182" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⊐</span><span class="mi" id="MathJax-Span-4183" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>s</mi><mi>u</mi></msub><mo>+</mo><mi>c</mi><mo>+</mo><msub><mi>s</mi><mi>v</mi></msub><mo stretchy="false">)</mo><mo>⊐</mo><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-370">(s_u + c + s_v) \sqsupset T</script>, 而且不同的 discontinues transition 对应的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-371-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4184" style="width: 6.556em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.124em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.08em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4185"><span class="mo" id="MathJax-Span-4186" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-4187"><span style="display: inline-block; position: relative; width: 0.827em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-4188" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-4189" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-4190" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mi" id="MathJax-Span-4191" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">c</span><span class="mo" id="MathJax-Span-4192" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="msubsup" id="MathJax-Span-4193" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.431em 1000.35em 4.125em -999.998em); top: -3.991em; left: 0em;"><span class="mi" id="MathJax-Span-4194" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.393em;"><span class="mi" id="MathJax-Span-4195" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 3.995em;"></span></span></span></span><span class="mo" id="MathJax-Span-4196" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>s</mi><mi>u</mi></msub><mo>+</mo><mi>c</mi><mo>+</mo><msub><mi>s</mi><mi>v</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-371">(s_u + c + s_v)</script> 各不相同. 因为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-372-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4197" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.653em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.65em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4198"><span class="mi" id="MathJax-Span-4199" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-372">T</script> 的 unique suffixes 数量的上限是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-373-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4200" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4201"><span class="mi" id="MathJax-Span-4202" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-373">n</script>, 所以 discontinues transition 的数量也是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-374-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4203" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.83em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4204"><span class="mi" id="MathJax-Span-4205" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-4206" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4207" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4208" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-374">O(n)</script>.</p>

<p>所以, transition 的数量是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-375-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4209" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.83em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4210"><span class="mi" id="MathJax-Span-4211" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-4212" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4213" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4214" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-375">O(n)</script>.</p>

<p>由此, SAM 的 space complexity 是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-376-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4215" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.83em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4216"><span class="mi" id="MathJax-Span-4217" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-4218" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4219" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4220" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-376">O(n)</script>.</p>

<p>接着我们来考虑 time complexity. 根据 SAM 的构建算法, 影响 time complexity 的操作有三种:</p>

<ol>
<li>第 (2) 步的创建 transitions.  </li>
<li>第 (5) 步的 copy transitions from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-377-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4221" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4222"><span class="mi" id="MathJax-Span-4223" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-377">q</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-378-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4224" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4225"><span class="mi" id="MathJax-Span-4226" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4227" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-378">sq</script>.  </li>
<li>第 (5) 步的重定向 transitions <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-379-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4228" style="width: 7.901em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.165em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.12em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4229"><span class="mi" id="MathJax-Span-4230" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4231" style="font-family: STIXGeneral-Italic;">h</span><span class="mi" id="MathJax-Span-4232" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4233" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4234" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4235" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4236" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4237" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4238" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mi" id="MathJax-Span-4239" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4240" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4241" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4242" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>h</mi><mi>i</mi><mi>l</mi><mi>d</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-379">ChildrenTrans</script>.</li>
</ol>

<p>显然, (1) 与 (2) 只涉及创建新的 transition, 由于 transition 的上限是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-380-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4243" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.83em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4244"><span class="mi" id="MathJax-Span-4245" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-4246" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4247" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4248" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-380">O(n)</script>, 所以均摊后 (1) 与 (2) 类操作的复杂度是 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-381-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4249" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.83em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4250"><span class="mi" id="MathJax-Span-4251" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-4252" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4253" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4254" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-381">O(n)</script>. 至于 (3) 我就不知道怎么证了, 我找到了一些 paper 说这个是可以证的, 但是具体怎么搞我没想清楚. 如果你有比较好的证明方法, 请务必告诉我, 我请你喝咖啡!</p>

<h2 id="statewithmoreinformation">State With More Information</h2>

<p>上文提到, 为了完成 SAM 的构建, 每个 State <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-382-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4255" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4256"><span class="mi" id="MathJax-Span-4257" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-382">u</script> 仅维护以下信息即可:</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-383-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4258" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4259"><span class="mi" id="MathJax-Span-4260" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4261" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4262" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4263" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4264" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4265" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4266" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4267" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4268" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-383">maxlen(u)</script></li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-384-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4269" style="width: 3.388em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.65em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.61em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4270"><span class="mi" id="MathJax-Span-4271" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4272" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4273" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4274" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4275" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4276" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4277" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-384">link(u)</script></li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-385-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4278" style="width: 5.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.299em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.26em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4279"><span class="mi" id="MathJax-Span-4280" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4281" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4282" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4283" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4284" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4285" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4286" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4287" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-4288" style="font-family: STIXGeneral-Regular; padding-left: 0.176em;">Σ</span><span class="mo" id="MathJax-Span-4289" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-385">trans(u, \Sigma)</script></li>
</ul>

<p>在解决实际问题的时候, 往往需要 State <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-386-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4290" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4291"><span class="mi" id="MathJax-Span-4292" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-386">u</script> 维护更多的信息, 例如:</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-387-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4293" style="width: 5.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.908em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.87em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4294"><span class="mi" id="MathJax-Span-4295" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4296" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4297" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4298" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4299" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4300" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4301" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4302" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4303" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-387">minlen(u)</script></li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-388-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4304" style="width: 8.118em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.339em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4305"><span class="mi" id="MathJax-Span-4306" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mi" id="MathJax-Span-4307" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4308" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4309" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4310" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4311" style="font-family: STIXGeneral-Regular;">_</span><span class="mi" id="MathJax-Span-4312" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4313" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4314" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4315" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4316" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4317" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4318" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4319" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4320" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-388">first\_endpos(u)</script>, 代表 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-389-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4321" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4322"><span class="mi" id="MathJax-Span-4323" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4324" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4325" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4326" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4327" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4328" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4329" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4330" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4331" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-389">endpos(u)</script> 中的最小下标.</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-390-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4332" style="width: 4.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.778em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.74em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4333"><span class="mi" id="MathJax-Span-4334" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4335" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4336" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4337" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4338" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4339" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4340" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4341" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4342" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-390">accept(u)</script>, boolean 值, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-391-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4343" style="width: 8.639em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.73em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.69em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4344"><span class="mi" id="MathJax-Span-4345" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4346" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4347" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4348" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4349" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4350" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4351" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4352" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4353" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4354" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4355" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4356" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4357" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4358" style="font-family: STIXGeneral-Italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-391">accept(u) = true</script> 代表 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-392-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4359" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4360"><span class="mi" id="MathJax-Span-4361" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-392">u</script> 是 accept state.</li>
</ul>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-393-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4362" style="width: 5.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.908em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.87em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4363"><span class="mi" id="MathJax-Span-4364" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4365" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4366" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4367" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4368" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4369" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4370" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4371" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4372" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-393">minlen(u)</script> 的维护是最简单的, 由于有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-394-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4373" style="width: 23.179em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.101em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1018.06em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4374"><span class="mi" id="MathJax-Span-4375" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-4376" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4377" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4378" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4379" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4380" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4381" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4382" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4383" style="font-family: STIXGeneral-Regular;">)</span><span class="mspace" id="MathJax-Span-4384" style="height: 0em; vertical-align: 0em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-4385" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">⟹</span><span class="mspace" id="MathJax-Span-4386" style="height: 0em; vertical-align: 0em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-4387" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-4388" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4389" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4390" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4391" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4392" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4393" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4394" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-4395" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4396" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-4397" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-4398" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4399" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-4400" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4401" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4402" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4403" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4404" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4405" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4406" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4407" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo>=</mo><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo stretchy="false">⟹</mo><mspace width="thickmathspace"></mspace><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-394">v = link(u) \implies maxlen(v) + 1 = minlen(u)</script>, 所以只要在更新 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-395-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4408" style="width: 3.388em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.65em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.61em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4409"><span class="mi" id="MathJax-Span-4410" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4411" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4412" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4413" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4414" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4415" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4416" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-395">link(u)</script> 的时候同时更新 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-396-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4417" style="width: 5.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.908em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.87em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4418"><span class="mi" id="MathJax-Span-4419" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4420" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4421" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4422" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4423" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4424" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4425" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4426" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4427" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-396">minlen(u)</script> 就好了, 也就是在 online construction 的 (3), (4), (5) 上加入对应的更新逻辑, 以下是加入 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-397-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4428" style="width: 5.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.908em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.87em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4429"><span class="mi" id="MathJax-Span-4430" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4431" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4432" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4433" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4434" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4435" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4436" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4437" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4438" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-397">minlen(u)</script> 维护操作的 pseudocode:</p>

<pre><code class=" line-numbers">Procedure Name: AddSymbolToSAM  
Input: start, last, T[i]  
Output: cur

# (1)
create state cur  
maxlen(cur) = maxlen(last) + 1

# (2)
p = last  
while p is not null AND trans(p, T[i]) not exists:  
  trans(p, T[i]) = cur
  p = link(p)

# (3)
if p is null:  
  link(cur) = start
  minlen(cur) = 1
  return cur

q = trans(p, T[i])  
if maxlen(p) + 1 = maxlen(q):  
  # (4)
  link(cur) = q
  minlen(cur) = maxlen(q) + 1
else:  
  # (5)
  create state sq
  maxlen(sq) = maxlen(p) + 1
  for all trans(q, c) = q':
    trans(sq, c) = q'

  while p is valid AND trans(p, T[i]) = q:
    trans(p, T[i]) = sq
    p = link(p)

  link(sq) = link(q)
  minlen(sq) = maxlen(link(sq)) + 1

  link(q) = sq
  minlen(q) = maxlen(sq) + 1

  link(cur) = sq
  minlen(cur) = maxlen(sq) + 1

reutrn cur  
</code></pre>

<p>其中:</p>

<ul>
<li>(3) 中因为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-398-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4439" style="width: 8.639em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.73em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.73em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4440"><span class="mi" id="MathJax-Span-4441" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4442" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4443" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4444" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4445" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4446" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4447" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4448" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-4449" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4450" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4451" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-4452" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4453" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4454" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4455" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-398">link(cur) = start</script>, 自然有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-399-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4456" style="width: 19.186em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.976em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1014.89em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4457"><span class="mi" id="MathJax-Span-4458" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4459" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4460" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4461" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4462" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4463" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4464" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4465" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4466" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4467" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-4468" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4469" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4470" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-4471" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4472" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4473" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4474" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4475" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4476" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4477" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4478" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4479" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4480" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4481" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4482" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4483" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-4484" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span><span class="mo" id="MathJax-Span-4485" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-4486" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-399">minlen(cur) = maxlen(start) + 1 = 1</script>.</li>
<li>(4) 中因为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-400-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4487" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.34em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4488"><span class="mi" id="MathJax-Span-4489" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4490" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4491" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4492" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4493" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4494" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4495" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4496" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-4497" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4498" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4499" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-400">link(cur) = q</script>, 自然有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-401-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4500" style="width: 15.106em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.808em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.72em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4501"><span class="mi" id="MathJax-Span-4502" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4503" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4504" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4505" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4506" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4507" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4508" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4509" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4510" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4511" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-4512" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4513" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4514" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">m</span><span class="mi" id="MathJax-Span-4515" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4516" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4517" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4518" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4519" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4520" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4521" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4522" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4523" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">+</span><span class="mn" id="MathJax-Span-4524" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-401">minlen(cur) = maxlen(q) + 1</script>.</li>
<li>(5) 中更新了 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-402-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4525" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4526"><span class="mi" id="MathJax-Span-4527" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4528" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-402">sq</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-403-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4529" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4530"><span class="mi" id="MathJax-Span-4531" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-403">q</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-404-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4532" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.39em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4533"><span class="mi" id="MathJax-Span-4534" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4535" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4536" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-404">cur</script> 的 suffix link, 只需要顺着对应的 suffix link 去拿到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-405-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4537" style="width: 3.735em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.91em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.87em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4538"><span class="mi" id="MathJax-Span-4539" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4540" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4541" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4542" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4543" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4544" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-405">maxlen</script>, 即可更新 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-406-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4545" style="width: 3.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.737em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1002.69em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4546"><span class="mi" id="MathJax-Span-4547" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4548" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4549" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4550" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4551" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4552" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-406">minlen</script>.</li>
</ul>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-407-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4553" style="width: 8.118em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.339em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4554"><span class="mi" id="MathJax-Span-4555" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mi" id="MathJax-Span-4556" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4557" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4558" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4559" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4560" style="font-family: STIXGeneral-Regular;">_</span><span class="mi" id="MathJax-Span-4561" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4562" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4563" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4564" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4565" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4566" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4567" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4568" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4569" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-407">first\_endpos(u)</script> 代表了 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-408-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4570" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4571"><span class="mi" id="MathJax-Span-4572" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-408">u</script> 的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-409-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4573" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4574"><span class="mi" id="MathJax-Span-4575" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4576" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4577" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4578" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4579" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4580" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4581" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4582" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4583" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-409">endpos(u)</script> 的最小下标. 仔细分析 online construction 的过程, 会发现:</p>

<ul>
<li>将 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-410-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4584" style="width: 2.086em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.608em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1001.52em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4585"><span class="mi" id="MathJax-Span-4586" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-4587" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-4588" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-4589" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-410">T[i]</script> 加入到 SAM 的时候, 会新建 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-411-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4590" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.39em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4591"><span class="mi" id="MathJax-Span-4592" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4593" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4594" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-411">cur</script>, 此时 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-412-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4595" style="width: 9.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.467em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1007.38em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4596"><span class="mi" id="MathJax-Span-4597" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4598" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4599" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4600" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4601" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4602" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4603" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4604" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4605" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4606" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-4607" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4608" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-4609" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">{</span><span class="mi" id="MathJax-Span-4610" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-4611" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false" stretchy="false">{</mo><mi>i</mi><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-412">endpos(cur) = \{i\}</script>.</li>
<li>(4) 中建立 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-413-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4612" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.341em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.34em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4613"><span class="mi" id="MathJax-Span-4614" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4615" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4616" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4617" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4618" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4619" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4620" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4621" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-4622" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4623" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4624" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-413">link(cur) = q</script> 之后, 会使 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-414-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4625" style="width: 0.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.26em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4626"><span class="mi" id="MathJax-Span-4627" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-414">i</script> 加入到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-415-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4628" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4629"><span class="mi" id="MathJax-Span-4630" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4631" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4632" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4633" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4634" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4635" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4636" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4637" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4638" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-415">endpos(q)</script> 中, 即 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-416-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4639" style="width: 15.063em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.764em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1011.72em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4640"><span class="mi" id="MathJax-Span-4641" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4642" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4643" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4644" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4645" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4646" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4647" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4648" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4649" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4650" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-4651" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">{</span><span class="mi" id="MathJax-Span-4652" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-4653" style="font-family: STIXGeneral-Regular;">}</span><span class="mo" id="MathJax-Span-4654" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">∪</span><span class="mi" id="MathJax-Span-4655" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">e</span><span class="mi" id="MathJax-Span-4656" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4657" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4658" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4659" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4660" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4661" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4662" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4663" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false" stretchy="false">{</mo><mi>i</mi><mo fence="false" stretchy="false">}</mo><mo>∪</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-416">endpos(q) = \{i\} \cup endpos(q)</script>.</li>
<li>(5) 中从 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-417-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4664" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.52em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4665"><span class="mi" id="MathJax-Span-4666" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-417">q</script> 分离出 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-418-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4667" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4668"><span class="mi" id="MathJax-Span-4669" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4670" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-418">sq</script> 之后, 会有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-419-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4671" style="width: 12.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.768em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1009.72em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4672"><span class="mi" id="MathJax-Span-4673" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4674" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4675" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4676" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4677" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4678" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4679" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4680" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4681" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4682" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4683" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4684" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">e</span><span class="mi" id="MathJax-Span-4685" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4686" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4687" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4688" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4689" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4690" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4691" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4692" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-419">endpos(sq) = endpos(q)</script>, 这个操作不会改变 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-420-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4693" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4694"><span class="mi" id="MathJax-Span-4695" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4696" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4697" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4698" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4699" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4700" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4701" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4702" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4703" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-420">endpos(q)</script>.</li>
<li>(5) 中建立 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-421-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4704" style="width: 7.337em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.731em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1005.73em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4705"><span class="mi" id="MathJax-Span-4706" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4707" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4708" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4709" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4710" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4711" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4712" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4713" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-4714" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4715" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4716" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">s</span><span class="mi" id="MathJax-Span-4717" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-421">link(cur) = sq</script> 之后, 会使 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-422-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4718" style="width: 0.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1000.26em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4719"><span class="mi" id="MathJax-Span-4720" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-422">i</script> 加入到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-423-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4721" style="width: 5.688em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.429em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004.39em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4722"><span class="mi" id="MathJax-Span-4723" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4724" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4725" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4726" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4727" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4728" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4729" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4730" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4731" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4732" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-423">endpos(sq)</script> 中, 即 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-424-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4733" style="width: 16.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.546em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1012.5em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4734"><span class="mi" id="MathJax-Span-4735" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4736" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4737" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4738" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4739" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4740" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4741" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4742" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4743" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4744" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4745" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-4746" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">{</span><span class="mi" id="MathJax-Span-4747" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-4748" style="font-family: STIXGeneral-Regular;">}</span><span class="mo" id="MathJax-Span-4749" style="font-family: STIXGeneral-Regular; padding-left: 0.263em;">∪</span><span class="mi" id="MathJax-Span-4750" style="font-family: STIXGeneral-Italic; padding-left: 0.263em;">e</span><span class="mi" id="MathJax-Span-4751" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4752" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4753" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4754" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4755" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4756" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4757" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4758" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4759" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo fence="false" stretchy="false">{</mo><mi>i</mi><mo fence="false" stretchy="false">}</mo><mo>∪</mo><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-424">endpos(sq) = \{i\} \cup endpos(sq)</script>, 同时 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-425-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4760" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4761"><span class="mi" id="MathJax-Span-4762" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4763" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4764" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4765" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4766" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4767" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4768" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4769" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4770" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-425">endpos(q)</script> 保持不变.</li>
</ul>

<p>通过分析发现, 对 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-426-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4771" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4772"><span class="mi" id="MathJax-Span-4773" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-426">u</script> 的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-427-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4774" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4775"><span class="mi" id="MathJax-Span-4776" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4777" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4778" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4779" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4780" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4781" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4782" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4783" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4784" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-427">endpos(u)</script> 的<strong>变更</strong>, 必然伴随着指向 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-428-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4785" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4786"><span class="mi" id="MathJax-Span-4787" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-428">u</script> 的 suffix link 的建立. 由此, state 只要在构建过程中维护 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-429-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4788" style="width: 8.118em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.339em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4789"><span class="mi" id="MathJax-Span-4790" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mi" id="MathJax-Span-4791" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4792" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4793" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4794" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4795" style="font-family: STIXGeneral-Regular;">_</span><span class="mi" id="MathJax-Span-4796" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4797" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4798" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4799" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4800" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4801" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4802" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4803" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4804" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-429">first\_endpos(u)</script>, 在后续应用中只要沿着 suffix link <strong>反向</strong> DFS, 即可得到 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-430-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4805" style="width: 5.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.039em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1004em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4806"><span class="mi" id="MathJax-Span-4807" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4808" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4809" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4810" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4811" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4812" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4813" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4814" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4815" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-430">endpos(u)</script>.</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-431-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4816" style="width: 8.118em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.339em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4817"><span class="mi" id="MathJax-Span-4818" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mi" id="MathJax-Span-4819" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4820" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4821" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4822" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4823" style="font-family: STIXGeneral-Regular;">_</span><span class="mi" id="MathJax-Span-4824" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4825" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4826" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4827" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4828" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4829" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4830" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4831" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4832" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-431">first\_endpos(u)</script> 的维护是很简单的:</p>

<ul>
<li>(1) 中新建 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-432-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4833" style="width: 1.782em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.391em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1001.39em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4834"><span class="mi" id="MathJax-Span-4835" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4836" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4837" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>u</mi><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-432">cur</script> 的时候设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-433-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4838" style="width: 11.243em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.77em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1008.77em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4839"><span class="mi" id="MathJax-Span-4840" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mi" id="MathJax-Span-4841" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4842" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4843" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4844" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4845" style="font-family: STIXGeneral-Regular;">_</span><span class="mi" id="MathJax-Span-4846" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4847" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4848" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4849" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4850" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4851" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4852" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4853" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4854" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-4855" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mo" id="MathJax-Span-4856" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4857" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4858" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">i</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-433">first\_endpos(cur) = i</script>.</li>
<li>(5) 中新建 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-434-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4859" style="width: 1.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.87em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4860"><span class="mi" id="MathJax-Span-4861" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4862" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-434">sq</script> 的时候设 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-435-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4863" style="width: 18.405em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.368em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1014.33em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4864"><span class="mi" id="MathJax-Span-4865" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mi" id="MathJax-Span-4866" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4867" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4868" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4869" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4870" style="font-family: STIXGeneral-Regular;">_</span><span class="mi" id="MathJax-Span-4871" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4872" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4873" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4874" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4875" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4876" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4877" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4878" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4879" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4880" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4881" style="font-family: STIXGeneral-Regular; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-4882" style="font-family: STIXGeneral-Italic; padding-left: 0.306em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mi" id="MathJax-Span-4883" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4884" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4885" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4886" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4887" style="font-family: STIXGeneral-Regular;">_</span><span class="mi" id="MathJax-Span-4888" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4889" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4890" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4891" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4892" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4893" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4894" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4895" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-4896" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>s</mi><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-435">first\_endpos(sq) = first\_endpos(q)</script>.</li>
</ul>

<p>以下是包含了 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-436-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4897" style="width: 5.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.908em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.87em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4898"><span class="mi" id="MathJax-Span-4899" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4900" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4901" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4902" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4903" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4904" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4905" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4906" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4907" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mi>l</mi><mi>e</mi><mi>n</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-436">minlen(u)</script> 与 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-437-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4908" style="width: 8.118em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.339em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1006.3em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4909"><span class="mi" id="MathJax-Span-4910" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.132em;"></span></span><span class="mi" id="MathJax-Span-4911" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4912" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4913" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4914" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4915" style="font-family: STIXGeneral-Regular;">_</span><span class="mi" id="MathJax-Span-4916" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4917" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-4918" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4919" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4920" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4921" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-4922" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4923" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4924" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>i</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi mathvariant="normal">_</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-437">first\_endpos(u)</script> 维护的 pseudocode:</p>

<pre><code class=" line-numbers">Procedure Name: AddSymbolToSAM  
Input: start, last, T[i]  
Output: cur

# (1)
create state cur  
maxlen(cur) = maxlen(last) + 1  
first_endpos(cur) = i

# (2)
p = last  
while p is not null AND trans(p, T[i]) not exists:  
  trans(p, T[i]) = cur
  p = link(p)

# (3)
if p is null:  
  link(cur) = start
  minlen(cur) = 1
  return cur

q = trans(p, T[i])  
if maxlen(p) + 1 = maxlen(q):  
  # (4)
  link(cur) = q
  minlen(cur) = maxlen(q) + 1
else:  
  # (5)
  create state sq
  maxlen(sq) = maxlen(p) + 1
  first_endpos(sq) = first_endpos(q)

  for all trans(q, c) = q':
    trans(sq, c) = q'

  while p is valid AND trans(p, T[i]) = q:
    trans(p, T[i]) = sq
    p = link(p)

  link(sq) = link(q)
  minlen(sq) = maxlen(link(sq)) + 1

  link(q) = sq
  minlen(q) = maxlen(sq) + 1

  link(cur) = sq
  minlen(cur) = maxlen(sq) + 1

reutrn cur  
</code></pre>

<p>最后提一下 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-438-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4925" style="width: 4.863em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.778em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1003.74em 2.823em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4926"><span class="mi" id="MathJax-Span-4927" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4928" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4929" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4930" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-4931" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-4932" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4933" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4934" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-4935" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-438">accept(u)</script> 的判定. 判断一个 state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-439-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4936" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4937"><span class="mi" id="MathJax-Span-4938" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-439">u</script> 是不是 SAM 的 accept state, 只需要看 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-440-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4939" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.912em 1000.48em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4940"><span class="mi" id="MathJax-Span-4941" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-440">u</script> 是否在 suffix-link path from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-441-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4942" style="width: 1.868em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.434em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.651em 1001.43em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4943"><span class="mi" id="MathJax-Span-4944" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4945" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4946" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4947" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>a</mi><mi>s</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-441">last</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-442-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4948" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.868em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.782em 1001.87em 2.606em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4949"><span class="mi" id="MathJax-Span-4950" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-4951" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4952" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4953" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.046em;"></span></span><span class="mi" id="MathJax-Span-4954" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-442">start</script> 的路径上就可以了, 唯有这条路径上的 state 包含 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-443-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4955" style="width: 2.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.825em; height: 0px; font-size: 128%;"><span style="position: absolute; clip: rect(1.695em 1001.74em 2.78em -999.998em); top: -2.472em; left: 0em;"><span class="mrow" id="MathJax-Span-4956"><span class="mi" id="MathJax-Span-4957" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.089em;"></span></span><span class="mo" id="MathJax-Span-4958" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-4959" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-4960" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.476em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-443">T[n]</script>.</p>

<p>所以, 只要在创建完 SAM 之后再扫一遍这个路径即可找出 SAM 的所有的 accept states. 对应的 pseudocode:</p>

<pre><code class=" line-numbers">Procedure Name: CreateSAM  
Input: T  
Output: start

create state start  
last = start  
accept(start) = false

for i in 1 to length(T):  
  last = AddSymbolToSAM(start, last, T[i])
  accept(last) = false

while last is not null:  
  accept(last) = true
  last = link(last)

return start  
</code></pre>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="https://huntzhan.org/author/hunt/" style="background-image: url(https://ocdnb8ugz.qnssl.com/huntzhan-compressed.jpg)"><span class="hidden">Hunt Zhan's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="https://huntzhan.org/author/hunt/">Hunt Zhan</a></h4>

                    <p>Read <a href="https://huntzhan.org/author/hunt/">more posts</a> by this author.</p>
                <div class="author-meta">
                    
                    
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Suffix%20Automaton%20Tutorial&amp;url=https://huntzhan.org/suffix-automaton-tutorial/" onclick="window.open(this.href, &#39;twitter-share&#39;, &#39;width=550,height=235&#39;);return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://huntzhan.org/suffix-automaton-tutorial/" onclick="window.open(this.href, &#39;facebook-share&#39;,&#39;width=580,height=296&#39;);return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https://huntzhan.org/suffix-automaton-tutorial/" onclick="window.open(this.href, &#39;google-plus-share&#39;, &#39;width=490,height=530&#39;);return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>


        </footer>

    </article>
</main>

<aside class="read-next">
    <a class="read-next-story no-cover" href="https://huntzhan.org/k-sum-xi-lie-yu-combination-xi-lie/">
        <section class="post">
            <h2>K Sum 系列与 Combination 系列</h2>
            <p>考察 Two Pointers 与 DFS. K Sum 系列: Two Sum | LeetCode OJ Two Sum II - Input array is…</p>
        </section>
    </a>
</aside>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="http://huntzhan.org/">Coding All The Ways</a> © 2017</section>
            <section class="poweredby">Proudly published with <a href="https://ghost.org/">Ghost</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="./SAM_files/jquery.min.js"></script>
    <!-- mathjax -->
<script type="text/javascript" src="./SAM_files/mathjax.js" async="">
</script>

<!-- prism -->
<!-- attach line-numbers class to code blocks -->
<script type="text/javascript">
for (let e of document.querySelectorAll('pre > code')) {
  e.className += " line-numbers";
}
</script>
<!-- load resource -->
<script type="text/javascript" id="load-prism" src="./SAM_files/prism.js" data-prism-theme="solarizedlight" data-prism-plugins="line-numbers" async="">
</script>


<!-- disqus -->
<!-- injected code -->
<div class="post">
<div id="disqus_thread" data-shortname="huntzhanorg">
</div>
</div>
<!-- load resource -->
<script type="text/javascript" src="./SAM_files/disqus.js" async="">
</script>
    <script type="text/javascript" src="./SAM_files/jquery.fitvids.js"></script>
    <script type="text/javascript" src="./SAM_files/index.js"></script>



<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>